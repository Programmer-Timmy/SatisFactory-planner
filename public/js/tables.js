!function(o,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.tables=n():o.tables=n()}(this,(()=>(()=>{"use strict";var o=function(o,n){void 0===o&&(o=0),void 0===n&&(n=0),this.itemId=o,this.quantity=n},n=function(){function o(){}return o.getRecipe=function(o){return new Promise((function(n,t){$.ajax({type:"GET",url:"getRecipe",data:{id:o},dataType:"json",success:function(o){try{n(o)}catch(o){t(o)}},error:function(o,n,e){t(e)}})}))},o.getBuilding=function(o){return new Promise((function(n,t){$.ajax({type:"GET",url:"getBuilding",data:{id:o},dataType:"json",success:function(o){try{n(o)}catch(o){t(o)}},error:function(o,n,e){t(e)}})}))},o.saveData=function(o,n){return t=this,e=void 0,a=function(){return function(o,n){var t,e,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(u){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(r=0)),r;)try{if(t=1,e&&(i=2&l[0]?e.return:l[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,l[1])).done)return i;switch(e=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,e=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=n.call(o,r)}catch(o){l=[6,o],e=0}finally{t=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}}(this,(function(t){return[2,new Promise((function(t,e){$.ajax({type:"POST",url:"saveProductionLine",data:{data:JSON.stringify(o),id:n},success:function(o){t(JSON.parse(o))},error:function(o,n,t){e(t)}})}))]}))},new((i=void 0)||(i=Promise))((function(o,n){function r(o){try{u(a.next(o))}catch(o){n(o)}}function l(o){try{u(a.throw(o))}catch(o){n(o)}}function u(n){var t;n.done?o(n.value):(t=n.value,t instanceof i?t:new i((function(o){o(t)}))).then(r,l)}u((a=a.apply(t,e||[])).next())}));var t,e,i,a},o}(),t=function(o,n,t,e){void 0===o&&(o=""),void 0===n&&(n=0),void 0===t&&(t=0),void 0===e&&(e=0),this.Product=o,this.Usage=n,this.ExportPerMin=t,this.Quantity=e},e=function(o,n,t,e){return new(t||(t=Promise))((function(i,a){function r(o){try{u(e.next(o))}catch(o){a(o)}}function l(o){try{u(e.throw(o))}catch(o){a(o)}}function u(o){var n;o.done?i(o.value):(n=o.value,n instanceof t?n:new t((function(o){o(n)}))).then(r,l)}u((e=e.apply(o,n||[])).next())}))},i=function(o,n){var t,e,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(u){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(r=0)),r;)try{if(t=1,e&&(i=2&l[0]?e.return:l[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,l[1])).done)return i;switch(e=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,e=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=n.call(o,r)}catch(o){l=[6,o],e=0}finally{t=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}},a=function(){function o(){}return o.calculateProductionExport=function(o){return e(this,void 0,void 0,(function(){var n;return i(this,(function(t){return o.exportPerMin=o.quantity-o.Usage,o.doubleExport&&null!==o.recipe&&void 0!==(n=this.calculateSecondExportPerMin(o))&&(o.extraCells.Quantity=n,o.extraCells.ExportPerMin=n),[2]}))}))},o.updateRecipe=function(o,n){return e(this,void 0,void 0,(function(){var e,a,r,l,u;return i(this,(function(i){switch(i.label){case 0:return[4,this.saveRecipe(n,o)];case 1:return i.sent(),null===(e=o.recipe)||(o.recipeId=e.id,o.product=e.itemName,o.doubleExport=null!==e.secondItemName,o.doubleExport&&(a=+e.export_amount_per_min,r=+e.export_amount_per_min2,l=r/a,u=o.quantity,o.extraCells=new t(e.secondItemName,0,u*l))),[2]}}))}))},o.saveRecipe=function(o,t){return e(this,void 0,void 0,(function(){var e;return i(this,(function(i){switch(i.label){case 0:return e=t,[4,n.getRecipe(+o)];case 1:return e.recipe=i.sent(),[2]}}))}))},o.handleDoubleExport=function(o,n){if(o.doubleExport&&null!==o.extraCells)if(n.next(".extra-output").length){var t=(i=n.next(".extra-output")).find('input[name="production_usage2[]"]'),e=i.find('input[name="production_export2[]"]');t.val(o.extraCells.Usage),e.val(o.extraCells.ExportPerMin)}else{var i;n.find("td:first").attr("rowspan",2),n.find("td:nth-child(2)").attr("rowspan",2),n.find("td:first select").css("height","78px"),n.find("td:nth-child(2) input").css("height","78px"),(i=$('\n                    <tr class="extra-output">\n                        <td class="m-0 p-0">\n                            <input type="text" name="product" value="'.concat(o.extraCells.Product,'" class="form-control rounded-0" readonly>\n                        </td>\n                        <td class="m-0 p-0">\n                            <input type="number" name="production_usage2[]" value="').concat(o.extraCells.Usage,'" class="form-control rounded-0" readonly step="any">\n                        </td>\n                        <td class="m-0 p-0">\n                            <input type="number" name="production_export2[]" value="').concat(o.extraCells.ExportPerMin,'" class="form-control rounded-0" readonly step="any">\n                        </td>\n                    </tr>\n                '))).insertAfter(n)}else n.next(".extra-output").length&&(n.next(".extra-output").remove(),n.find("td:first").removeAttr("rowspan"),n.find("td:nth-child(2)").removeAttr("rowspan"),n.find("td:first select").css("height",""),n.find("td:nth-child(2) input").css("height",""))},o.calculateSecondExportPerMin=function(o){if(null!==o.recipe){var n=o.recipe.export_amount_per_min2,t=o.recipe.export_amount_per_min;if(null!==n&&null!==t){var e=n/t;return o.quantity*e}}},o}(),r=function(){function o(o,n,t,e,i,a,r){void 0===o&&(o=""),void 0===n&&(n=0),void 0===t&&(t=""),void 0===e&&(e=0),void 0===i&&(i=0),void 0===a&&(a=!1),void 0===r&&(r=null);var l=this;this.recipeId=+o,this.quantity=n,this.product=t,this.Usage=e,this.exportPerMin=i,this.doubleExport=a,this.extraCells=r,this.recipe=null,this.import=null,this.productionImport=[],this.getRecipe(o).then((function(o){return l.saveDoubleExportQuantity()}))}return o.prototype.getRecipe=function(o){return t=this,e=void 0,a=function(){var t;return function(o,n){var t,e,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(u){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(r=0)),r;)try{if(t=1,e&&(i=2&l[0]?e.return:l[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,l[1])).done)return i;switch(e=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,e=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=n.call(o,r)}catch(o){l=[6,o],e=0}finally{t=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}}(this,(function(e){switch(e.label){case 0:return t=this,[4,n.getRecipe(+o)];case 1:return t.recipe=e.sent(),[2]}}))},new((i=void 0)||(i=Promise))((function(o,n){function r(o){try{u(a.next(o))}catch(o){n(o)}}function l(o){try{u(a.throw(o))}catch(o){n(o)}}function u(n){var t;n.done?o(n.value):(t=n.value,t instanceof i?t:new i((function(o){o(t)}))).then(r,l)}u((a=a.apply(t,e||[])).next())}));var t,e,i,a},o.prototype.saveDoubleExportQuantity=function(){this.doubleExport&&null!==this.extraCells&&(this.extraCells.Quantity=a.calculateSecondExportPerMin(this))},o}(),l=function(o,t,e,i,a,r){void 0===o&&(o=NaN),void 0===t&&(t=0),void 0===e&&(e=100),void 0===i&&(i=0),void 0===a&&(a=!0),void 0===r&&(r=null);var l=this;this.buildingId=o,this.quantity=t,this.clockSpeed=e,this.Consumption=i,this.userRow=a,this.building=r,isNaN(o)||null===o||null!==r||n.getBuilding(o).then((function(o){l.building=o}))},u='\n  <option value="" disabled>Select a building</option>\n  <option value="16">Assembler</option>\n  <option value="17">Blender</option>\n  <option value="19">Constructor</option>\n  <option value="6">Converter</option>\n  <option value="13">Foundry</option>\n  <option value="21">Main Portal</option>\n  <option value="15">Manufacturer</option>\n  <option value="10">Miner Mk.1</option>\n  <option value="9">Miner Mk.2</option>\n  <option value="11">Miner Mk.3</option>\n  <option value="8">Oil Extractor</option>\n  <option value="14">Packager</option>\n  <option value="7">Particle Accelerator</option>\n  <option value="5">Quantum Encoder</option>\n  <option value="12">Refinery</option>\n  <option value="22">Satellite Portal</option>\n  <option value="18">Smelter</option>\n  <option value="4">Water Extractor</option>\n',p='\n<option value="" disabled>Select an item</option>\n<option value="111">Actual Snow</option>\n<option value="82">Adaptive Control Unit</option>\n<option value="48">AI Expansion Server</option>\n<option value="79">AI Limiter</option>\n<option value="45">Alclad Aluminum Sheet</option>\n<option value="102">Alien DNA Capsule</option>\n<option value="100">Alien Protein</option>\n<option value="72">Alumina Solution</option>\n<option value="71">Aluminum Casing</option>\n<option value="7">Aluminum Ingot</option>\n<option value="70">Aluminum Scrap</option>\n<option value="56">Assembly Director System</option>\n<option value="77">Automated Wiring</option>\n<option value="98">Ballistic Warp Drive</option>\n<option value="8">Battery</option>\n<option value="128">Bauxite</option>\n<option value="55">Biochemical Sculptor</option>\n<option value="137">Biomass</option>\n<option value="95">Black Powder</option>\n<option value="117">Blue FICSMAS Ornament</option>\n<option value="101">Blue Power Slug</option>\n<option value="20">Cable</option>\n<option value="110">Candy Cane</option>\n<option value="57">Caterium Ingot</option>\n<option value="129">Caterium Ore</option>\n<option value="59">Circuit Board</option>\n<option value="123">Coal</option>\n<option value="14">Compacted Coal</option>\n<option value="73">Computer</option>\n<option value="3">Concrete</option>\n<option value="37">Cooling System</option>\n<option value="113">Copper FICSMAS Ornament</option>\n<option value="69">Copper Ingot</option>\n<option value="130">Copper Ore</option>\n<option value="88">Copper Powder</option>\n<option value="26">Copper Sheet</option>\n<option value="134">Crude Oil</option>\n<option value="32">Crystal Oscillator</option>\n<option value="34">Dark Matter Crystal</option>\n<option value="41">Dark Matter Residue</option>\n<option value="44">Diamonds</option>\n<option value="93">Dissolved Silica</option>\n<option value="90">Electromagnetic Control Rod</option>\n<option value="58">Empty Canister</option>\n<option value="31">Empty Fluid Tank</option>\n<option value="61">Encased Industrial Beam</option>\n<option value="84">Encased Plutonium Cell</option>\n<option value="92">Encased Uranium Cell</option>\n<option value="43">Excited Photonic Matter</option>\n<option value="146">Fabric</option>\n<option value="54">Ficsite Ingot</option>\n<option value="38">Ficsite Trigon</option>\n<option value="112">FICSMAS Bow</option>\n<option value="109">FICSMAS Decoration</option>\n<option value="118">FICSMAS Gift</option>\n<option value="108">FICSMAS Ornament Bundle</option>\n<option value="115">FICSMAS Tree Branch</option>\n<option value="107">FICSMAS Wonder Star</option>\n<option value="96">Ficsonium</option>\n<option value="121">Ficsonium Fuel Rod</option>\n<option value="24">Fuel</option>\n<option value="52">Fused Modular Frame</option>\n<option value="99">Gas Filter</option>\n<option value="150">Hatcher Remains</option>\n<option value="89">Heat Sink</option>\n<option value="74">Heavy Modular Frame</option>\n<option value="64">Heavy Oil Residue</option>\n<option value="76">High-Speed Connector</option>\n<option value="147">Hog Remains</option>\n<option value="13">Iodine-Infused Filter</option>\n<option value="35">Ionized Fuel</option>\n<option value="114">Iron FICSMAS Ornament</option>\n<option value="21">Iron Ingot</option>\n<option value="122">Iron Ore</option>\n<option value="5">Iron Plate</option>\n<option value="18">Iron Rod</option>\n<option value="138">Leaves</option>\n<option value="132">Limestone</option>\n<option value="141">Liquid Biofuel</option>\n<option value="49">Magnetic Field Generator</option>\n<option value="103">Mercer Sphere</option>\n<option value="81">Modular Engine</option>\n<option value="27">Modular Frame</option>\n<option value="33">Motor</option>\n<option value="139">Mycelia</option>\n<option value="47">Neural-Quantum Processor</option>\n<option value="29">Nitric Acid</option>\n<option value="125">Nitrogen Gas</option>\n<option value="86">Non-Fissile Uranium</option>\n<option value="91">Nuclear Pasta</option>\n<option value="142">Packaged Alumina Solution</option>\n<option value="9">Packaged Fuel</option>\n<option value="15">Packaged Heavy Oil Residue</option>\n<option value="10">Packaged Ionized Fuel</option>\n<option value="136">Packaged Liquid Biofuel</option>\n<option value="144">Packaged Nitric Acid</option>\n<option value="143">Packaged Nitrogen Gas</option>\n<option value="17">Packaged Oil</option>\n<option value="11">Packaged Rocket Fuel</option>\n<option value="145">Packaged Sulfuric Acid</option>\n<option value="12">Packaged Turbofuel</option>\n<option value="68">Packaged Water</option>\n<option value="16">Petroleum Coke</option>\n<option value="60">Plastic</option>\n<option value="120">Plutonium Fuel Rod</option>\n<option value="85">Plutonium Pellet</option>\n<option value="2">Plutonium Waste</option>\n<option value="63">Polymer Resin</option>\n<option value="83">Pressure Conversion Cube</option>\n<option value="104">Purple Power Slug</option>\n<option value="65">Quartz Crystal</option>\n<option value="80">Quickwire</option>\n<option value="53">Radio Control Unit</option>\n<option value="131">Raw Quartz</option>\n<option value="42">Reanimated SAM</option>\n<option value="116">Red FICSMAS Ornament</option>\n<option value="22">Reinforced Iron Plate</option>\n<option value="25">Rocket Fuel</option>\n<option value="23">Rotor</option>\n<option value="62">Rubber</option>\n<option value="127">SAM</option>\n<option value="50">SAM Fluctuator</option>\n<option value="28">Screw</option>\n<option value="4">Silica</option>\n<option value="97">Singularity Cell</option>\n<option value="75">Smart Plating</option>\n<option value="106">Smokeless Powder</option>\n<option value="135">Solid Biofuel</option>\n<option value="148">Spitter Remains</option>\n<option value="78">Stator</option>\n<option value="6">Steel Beam</option>\n<option value="66">Steel Ingot</option>\n<option value="51">Steel Pipe</option>\n<option value="149">Stinger Remains</option>\n<option value="126">Sulfur</option>\n<option value="87">Sulfuric Acid</option>\n<option value="36">Supercomputer</option>\n<option value="46">Superposition Oscillator</option>\n<option value="94">Thermal Propulsion Rocket</option>\n<option value="40">Time Crystal</option>\n<option value="39">Turbo Motor</option>\n<option value="30">Turbofuel</option>\n<option value="133">Uranium</option>\n<option value="119">Uranium Fuel Rod</option>\n<option value="1">Uranium Waste</option>\n<option value="67">Versatile Framework</option>\n<option value="124">Water</option>\n<option value="19">Wire</option>\n<option value="140">Wood</option>\n<option value="105">Yellow Power Slug</option>\n',c='\n    <option value="" disabled>Select a recipe</option>\n    <option value="259">Actual Snow</option>\n    <option value="116">Adaptive Control Unit</option>\n    <option value="14">AI Expansion Server</option>\n    <option value="110">AI Limiter</option>\n    <option value="95">Alclad Aluminum Sheet</option>\n    <option value="245">Alien DNA Capsule</option>\n    <option value="242">Alien Power Matrix</option>\n    <option value="133">Alternate: Adhered Iron Plate</option>\n    <option value="177">Alternate: Alclad Casing</option>\n    <option value="182">Alternate: Aluminum Beam</option>\n    <option value="183">Alternate: Aluminum Rod</option>\n    <option value="105">Alternate: Automated Speed Wiring</option>\n    <option value="189">Alternate: Basic Iron Ingot</option>\n    <option value="49">Alternate: Biocoal</option>\n    <option value="132">Alternate: Bolted Frame</option>\n    <option value="208">Alternate: Bolted Iron Plate</option>\n    <option value="204">Alternate: Cast Screw</option>\n    <option value="227">Alternate: Caterium Circuit Board</option>\n    <option value="226">Alternate: Caterium Computer</option>\n    <option value="194">Alternate: Caterium Wire</option>\n    <option value="48">Alternate: Charcoal</option>\n    <option value="202">Alternate: Cheap Silica</option>\n    <option value="176">Alternate: Classic Battery</option>\n    <option value="62">Alternate: Cloudy Diamonds</option>\n    <option value="131">Alternate: Coated Cable</option>\n    <option value="130">Alternate: Coated Iron Canister</option>\n    <option value="129">Alternate: Coated Iron Plate</option>\n    <option value="128">Alternate: Coke Steel Ingot</option>\n    <option value="50">Alternate: Compacted Coal</option>\n    <option value="215">Alternate: Compacted Steel Ingot</option>\n    <option value="175">Alternate: Cooling Device</option>\n    <option value="127">Alternate: Copper Alloy Ingot</option>\n    <option value="122">Alternate: Copper Rotor</option>\n    <option value="225">Alternate: Crystal Computer</option>\n    <option value="64">Alternate: Dark Matter Crystallization</option>\n    <option value="63">Alternate: Dark Matter Trap</option>\n    <option value="8">Alternate: Dark-Ion Fuel</option>\n    <option value="174">Alternate: Diluted Fuel</option>\n    <option value="121">Alternate: Diluted Packaged Fuel</option>\n    <option value="185">Alternate: Distilled Silica</option>\n    <option value="173">Alternate: Electric Motor</option>\n    <option value="120">Alternate: Electrode Aluminum Scrap</option>\n    <option value="119">Alternate: Electrode Circuit Board</option>\n    <option value="222">Alternate: Electromagnetic Connection Rod</option>\n    <option value="206">Alternate: Encased Industrial Pipe</option>\n    <option value="172">Alternate: Fertile Uranium</option>\n    <option value="221">Alternate: Fine Black Powder</option>\n    <option value="224">Alternate: Fine Concrete</option>\n    <option value="118">Alternate: Flexible Framework</option>\n    <option value="187">Alternate: Fused Quartz Crystal</option>\n    <option value="210">Alternate: Fused Quickwire</option>\n    <option value="117">Alternate: Fused Wire</option>\n    <option value="220">Alternate: Heat Exchanger</option>\n    <option value="171">Alternate: Heat-Fused Frame</option>\n    <option value="219">Alternate: Heavy Encased Frame</option>\n    <option value="112">Alternate: Heavy Flexible Frame</option>\n    <option value="111">Alternate: Heavy Oil Residue</option>\n    <option value="196">Alternate: Infused Uranium Cell</option>\n    <option value="170">Alternate: Instant Plutonium Cell</option>\n    <option value="169">Alternate: Instant Scrap</option>\n    <option value="230">Alternate: Insulated Cable</option>\n    <option value="223">Alternate: Insulated Crystal Oscillator</option>\n    <option value="217">Alternate: Iron Alloy Ingot</option>\n    <option value="179">Alternate: Iron Pipe</option>\n    <option value="195">Alternate: Iron Wire</option>\n    <option value="193">Alternate: Leached Caterium Ingot</option>\n    <option value="191">Alternate: Leached Copper Ingot</option>\n    <option value="188">Alternate: Leached Iron ingot</option>\n    <option value="181">Alternate: Molded Beam</option>\n    <option value="178">Alternate: Molded Steel Pipe</option>\n    <option value="4">Alternate: Nitro Rocket Fuel</option>\n    <option value="163">Alternate: OC Supercomputer</option>\n    <option value="61">Alternate: Oil-Based Diamonds</option>\n    <option value="60">Alternate: Petroleum Diamonds</option>\n    <option value="59">Alternate: Pink Diamonds</option>\n    <option value="184">Alternate: Plastic AI Limiter</option>\n    <option value="104">Alternate: Plastic Smart Plating</option>\n    <option value="162">Alternate: Plutonium Fuel Unit</option>\n    <option value="248">Alternate: Polyester Fabric</option>\n    <option value="103">Alternate: Polymer Resin</option>\n    <option value="93">Alternate: Pure Aluminum Ingot</option>\n    <option value="92">Alternate: Pure Caterium Ingot</option>\n    <option value="91">Alternate: Pure Copper Ingot</option>\n    <option value="90">Alternate: Pure Iron Ingot</option>\n    <option value="88">Alternate: Pure Quartz Crystal</option>\n    <option value="186">Alternate: Quartz Purification</option>\n    <option value="229">Alternate: Quickwire Cable</option>\n    <option value="201">Alternate: Quickwire Stator</option>\n    <option value="209">Alternate: Radio Connection Unit</option>\n    <option value="161">Alternate: Radio Control System</option>\n    <option value="211">Alternate: Recycled Plastic</option>\n    <option value="87">Alternate: Recycled Rubber</option>\n    <option value="213">Alternate: Rigor Motor</option>\n    <option value="86">Alternate: Rubber Concrete</option>\n    <option value="228">Alternate: Silicon Circuit Board</option>\n    <option value="218">Alternate: Silicon High-Speed Connector</option>\n    <option value="160">Alternate: Sloppy Alumina</option>\n    <option value="216">Alternate: Solid Steel Ingot</option>\n    <option value="85">Alternate: Steamed Copper Sheet</option>\n    <option value="72">Alternate: Steel Canister</option>\n    <option value="180">Alternate: Steel Cast Plate</option>\n    <option value="67">Alternate: Steel Rod</option>\n    <option value="205">Alternate: Steel Rotor</option>\n    <option value="203">Alternate: Steel Screw</option>\n    <option value="214">Alternate: Steeled Frame</option>\n    <option value="207">Alternate: Stitched Iron Plate</option>\n    <option value="156">Alternate: Super-State Computer</option>\n    <option value="192">Alternate: Tempered Caterium Ingot</option>\n    <option value="190">Alternate: Tempered Copper Ingot</option>\n    <option value="145">Alternate: Turbo Blend Fuel</option>\n    <option value="18">Alternate: Turbo Diamonds</option>\n    <option value="198">Alternate: Turbo Electric Motor</option>\n    <option value="66">Alternate: Turbo Heavy Fuel</option>\n    <option value="134">Alternate: Turbo Pressure Motor</option>\n    <option value="212">Alternate: Uranium Fuel Unit</option>\n    <option value="65">Alternate: Wet Concrete</option>\n    <option value="96">Alumina Solution</option>\n    <option value="94">Aluminum Casing</option>\n    <option value="99">Aluminum Ingot</option>\n    <option value="97">Aluminum Scrap</option>\n    <option value="153">Assembly Director System</option>\n    <option value="109">Automated Wiring</option>\n    <option value="234">Ballistic Warp Drive</option>\n    <option value="148">Battery</option>\n    <option value="28">Bauxite (Caterium)</option>\n    <option value="29">Bauxite (Copper)</option>\n    <option value="25">Biochemical Sculptor</option>\n    <option value="240">Biomass (Mycelia)</option>\n    <option value="246">Biomass (Alien Protein)</option>\n    <option value="263">Biomass (Leaves)</option>\n    <option value="264">Biomass (Wood)</option>\n    <option value="241">Black Powder</option>\n    <option value="256">Blue FICSMAS Ornament</option>\n    <option value="268">Cable</option>\n    <option value="262">Candy Cane</option>\n    <option value="197">Caterium Ingot</option>\n    <option value="30">Caterium Ore (Copper)</option>\n    <option value="31">Caterium Ore (Quartz)</option>\n    <option value="51">Circuit Board</option>\n    <option value="32">Coal (Iron)</option>\n    <option value="33">Coal (Limestone)</option>\n    <option value="113">Computer</option>\n    <option value="266">Concrete</option>\n    <option value="147">Cooling System</option>\n    <option value="257">Copper FICSMAS Ornament</option>\n    <option value="270">Copper Ingot</option>\n    <option value="34">Copper Ore (Quartz)</option>\n    <option value="35">Copper Ore (Sulfur)</option>\n    <option value="139">Copper Powder</option>\n    <option value="125">Copper Sheet</option>\n    <option value="101">Crystal Oscillator</option>\n    <option value="11">Dark Matter Crystal</option>\n    <option value="9">Dark Matter Residue</option>\n    <option value="23">Diamonds</option>\n    <option value="157">Electromagnetic Control Rod</option>\n    <option value="73">Empty Canister</option>\n    <option value="166">Empty Fluid Tank</option>\n    <option value="106">Encased Industrial Beam</option>\n    <option value="135">Encased Plutonium Cell</option>\n    <option value="146">Encased Uranium Cell</option>\n    <option value="10">Excited Photonic Matter</option>\n    <option value="249">Fabric</option>\n    <option value="21">Ficsite Ingot (Iron)</option>\n    <option value="26">Ficsite Ingot (Aluminum)</option>\n    <option value="27">Ficsite Ingot (Caterium)</option>\n    <option value="20">Ficsite Trigon</option>\n    <option value="261">FICSMAS Bow</option>\n    <option value="253">FICSMAS Decoration</option>\n    <option value="254">FICSMAS Ornament Bundle</option>\n    <option value="260">FICSMAS Tree Branch</option>\n    <option value="252">FICSMAS Wonder Star</option>\n    <option value="231">Ficsonium</option>\n    <option value="232">Ficsonium Fuel Rod</option>\n    <option value="52">Fuel</option>\n    <option value="165">Fused Modular Frame</option>\n    <option value="247">Gas Filter</option>\n    <option value="244">Hatcher Protein</option>\n    <option value="164">Heat Sink</option>\n    <option value="114">Heavy Modular Frame</option>\n    <option value="154">High-Speed Connector</option>\n    <option value="238">Hog Protein</option>\n    <option value="235">Iodine-Infused Filter</option>\n    <option value="15">Ionized Fuel</option>\n    <option value="258">Iron FICSMAS Ornament</option>\n    <option value="3">Iron Ingot</option>\n    <option value="36">Iron Ore (Limestone)</option>\n    <option value="1">Iron Plate</option>\n    <option value="2">Iron Rod</option>\n    <option value="37">Limestone (Sulfur)</option>\n    <option value="75">Liquid Biofuel</option>\n    <option value="159">Magnetic Field Generator</option>\n    <option value="115">Modular Engine</option>\n    <option value="123">Modular Frame</option>\n    <option value="107">Motor</option>\n    <option value="13">Neural-Quantum Processor</option>\n    <option value="137">Nitric Acid</option>\n    <option value="38">Nitrogen Gas (Bauxite)</option>\n    <option value="39">Nitrogen Gas (Caterium)</option>\n    <option value="138">Non-Fissile Uranium</option>\n    <option value="143">Nuclear Pasta</option>\n    <option value="98">Packaged Alumina Solution</option>\n    <option value="74">Packaged Fuel</option>\n    <option value="78">Packaged Heavy Oil Residue</option>\n    <option value="16">Packaged Ionized Fuel</option>\n    <option value="76">Packaged Liquid Biofuel</option>\n    <option value="142">Packaged Nitric Acid</option>\n    <option value="167">Packaged Nitrogen Gas</option>\n    <option value="77">Packaged Oil</option>\n    <option value="6">Packaged Rocket Fuel</option>\n    <option value="152">Packaged Sulfuric Acid</option>\n    <option value="46">Packaged Turbofuel</option>\n    <option value="79">Packaged Water</option>\n    <option value="53">Petroleum Coke</option>\n    <option value="54">Plastic</option>\n    <option value="141">Plutonium Fuel Rod</option>\n    <option value="140">Plutonium Pellet</option>\n    <option value="136">Pressure Conversion Cube</option>\n    <option value="89">Quartz Crystal</option>\n    <option value="236">Quickwire</option>\n    <option value="150">Radio Control Unit</option>\n    <option value="40">Raw Quartz (Bauxite)</option>\n    <option value="41">Raw Quartz (Coal)</option>\n    <option value="24">Reanimated SAM</option>\n    <option value="255">Red FICSMAS Ornament</option>\n    <option value="265">Reinforced Iron Plate</option>\n    <option value="56">Residual Fuel</option>\n    <option value="57">Residual Plastic</option>\n    <option value="58">Residual Rubber</option>\n    <option value="5">Rocket Fuel</option>\n    <option value="124">Rotor</option>\n    <option value="55">Rubber</option>\n    <option value="19">SAM Fluctuator</option>\n    <option value="267">Screw</option>\n    <option value="100">Silica</option>\n    <option value="233">Singularity Cell</option>\n    <option value="126">Smart Plating</option>\n    <option value="251">Smokeless Powder</option>\n    <option value="237">Solid Biofuel</option>\n    <option value="239">Spitter Protein</option>\n    <option value="108">Stator</option>\n    <option value="68">Steel Beam</option>\n    <option value="70">Steel Ingot</option>\n    <option value="69">Steel Pipe</option>\n    <option value="243">Stinger Protein</option>\n    <option value="42">Sulfur (Coal)</option>\n    <option value="43">Sulfur (Iron)</option>\n    <option value="151">Sulfuric Acid</option>\n    <option value="149">Supercomputer</option>\n    <option value="12">Superposition Oscillator</option>\n    <option value="250">Synthetic Power Shard</option>\n    <option value="200">Thermal Propulsion Rocket</option>\n    <option value="22">Time Crystal</option>\n    <option value="199">Turbo Motor</option>\n    <option value="45">Turbofuel</option>\n    <option value="102">Unpackage Alumina Solution</option>\n    <option value="81">Unpackage Fuel</option>\n    <option value="83">Unpackage Heavy Oil Residue</option>\n    <option value="17">Unpackage Ionized Fuel</option>\n    <option value="80">Unpackage Liquid Biofuel</option>\n    <option value="144">Unpackage Nitric Acid</option>\n    <option value="168">Unpackage Nitrogen Gas</option>\n    <option value="82">Unpackage Oil</option>\n    <option value="7">Unpackage Rocket Fuel</option>\n    <option value="155">Unpackage Sulfuric Acid</option>\n    <option value="47">Unpackage Turbofuel</option>\n    <option value="84">Unpackage Water</option>\n    <option value="158">Uranium Fuel Rod</option>\n    <option value="44">Uranium Ore (Bauxite)</option>\n    <option value="71">Versatile Framework</option>\n    <option value="269">Wire</option>\n',s=function(){function o(){}return o.generatePowerTable=function(o,n,t){return o.map((function(o,t){return'\n      <tr>\n        <td class="m-0 p-0 w-50">\n          <select class="form-control rounded-0" name="power_building_id[]" min="0">\n            '.concat(n.replace('<option value="'.concat(o.buildingId,'">'),'<option value="'.concat(o.buildingId,'" selected>')),'\n          </select>\n        </td>\n        <td class="m-0 p-0 w-25">\n          <input type="number" value="').concat(o.quantity,'" class="form-control rounded-0" name="power_amount[]" min="0" step="any" data-index="').concat(t,'" onchange="updateConsumption()">\n        </td>\n        <td class="m-0 p-0 w-25">\n          <input type="number" value="').concat(o.clockSpeed,'" class="form-control rounded-0" name="power_clock_speed[]" min="1" max="250" step="any" data-index="').concat(t,'" onchange="updateConsumption()">\n        </td>\n        <td class="m-0 p-0 w-25">\n          <input type="number" value="').concat(o.Consumption,'" class="form-control rounded-0" disabled name="power_Consumption[]" min="0" step="any">\n        </td>\n        <td class="m-0 p-0 w-25">\n          <input type="hidden" value="').concat(o.userRow?1:0,'" class="form-control rounded-0" readonly name="user[]" min="0">\n        </td>\n      </tr>\n    ')})).join("")+'\n      <tr>\n        <td class="m-0 p-0 w-50">\n          <select class="form-control rounded-0" name="power_building_id[]" min="0">\n            '.concat(n.replace(/<option /,"<option selected "),' \x3c!-- Selects the first option --\x3e\n          </select>\n        </td>\n        <td class="m-0 p-0 w-25">\n          <input type="number" value="0" class="form-control rounded-0" name="power_amount[]" min="0" step="any" onchange="updateConsumption()">\n        </td>\n        <td class="m-0 p-0 w-25">\n          <input type="number" value="100" class="form-control rounded-0" name="power_clock_speed[]" min="1" max="250" step="any" onchange="updateConsumption()">\n        </td>\n        <td class="m-0 p-0 w-25">\n          <input type="number" value="0" class="form-control rounded-0" readonly name="power_Consumption[]" min="0" step="any">\n        </td>\n        <td class="m-0 p-0 w-25">\n          <input type="hidden" value="1" class="form-control rounded-0" readonly name="user[]" min="0">\n        </td>\n      </tr>\n    ')+'\n      <tr>\n        <td colspan="1" class="table-dark">\n          Total:\n        </td>\n        <td colspan="2"></td>\n        <td class="w-25 m-0 p-0">\n          <input type="number" name="total_consumption" readonly class="form-control rounded-0" id="totalConsumption" value="'.concat(t,'">\n        </td>\n      </tr>\n    ')},o.generateImportsTableRows=function(o){return o.map((function(o){var n=Number(o.quantity)%1==0?o.quantity.toFixed(0):o.quantity.toFixed(1);return'\n            <tr>\n                <td class="m-0 p-0 w-75">\n                    <select name="imports_item_id[]" class="form-control rounded-0">\n                        '.concat(p.replace('value="'.concat(o.itemId,'"'),'value="'.concat(o.itemId,'" selected')),'\n                    </select>\n                </td>\n                <td class="m-0 p-0 w-25">\n                    <input min="0" type="number" name="imports_ammount[]" class="form-control rounded-0" value="').concat(n,'" readonly>\n                </td>\n            </tr>\n        ')})).join("")+'\n        <tr>\n            <td class="m-0 p-0 w-75">\n                <select name="imports_item_id[]" class="form-control rounded-0">\n                    '.concat(p.replace(/<option /,"<option selected "),' \x3c!-- Selects the first option --\x3e\n                </select>\n            </td>\n            <td class="m-0 p-0 w-25">\n                <input min="0" type="number" name="imports_ammount[]" class="form-control rounded-0">\n            </td>\n        </tr>')},o.generateProductionTableRows=function(o){return o.map((function(o){var n,t,e,i="",a="",r="";return o.doubleExport&&(i='style="height: 78px"',r='rowspan="2"',a='\n            <tr class="extra-output">\n                <td class="m-0 p-0">\n                    <input type="text" readonly class="form-control rounded-0 product-name" value="'.concat(null===(n=o.extraCells)||void 0===n?void 0:n.Product,'">\n                </td>\n                <td class="m-0 p-0">\n                    <input min="0" type="number" step="any" name="production_usage2[]" value="').concat(null===(t=o.extraCells)||void 0===t?void 0:t.Usage,'" required readonly class="form-control rounded-0 usage-amount">\n                </td>\n                <td class="m-0 p-0">\n                    <input min="0" type="number" step="any" name="production_export2[]" value="').concat(null===(e=o.extraCells)||void 0===e?void 0:e.Quantity,'" required readonly class="form-control rounded-0 export-amount">\n                </td>\n            </tr>\n            ')),' <tr>\n          <td class="m-0 p-0" '.concat(r,'>\n            <select name="production_recipe_id[]" class="form-control rounded-0 item-recipe-id recipe" ').concat(i,">\n              ").concat(c.replace('value="'.concat(o.recipeId,'"'),'value="'.concat(o.recipeId,'" selected')),'\n            </select>\n          </td>\n          <td class="m-0 p-0" ').concat(r,'>\n            <input min="0" type="number" step="any" name="production_quantity[]" value="').concat(o.quantity,'" required class="form-control rounded-0 production-quantity" ').concat(i,'>\n          </td>\n          <td class="m-0 p-0">\n            <input type="text" readonly class="form-control rounded-0 product-name" value="').concat(o.product,'">\n          </td>\n          <td class="m-0 p-0">\n            <input min="0" type="number" step="any" name="production_usage[]" value="').concat(o.Usage,'" required readonly class="form-control rounded-0 usage-amount">\n          </td>\n          <td class="m-0 p-0">\n            <input min="0" type="number" step="any" name="production_export[]" value="').concat(o.exportPerMin,'" required readonly class="form-control rounded-0 export-amount">\n          </td>\n        </tr>\n        ').concat(a,"\n        ")})).join("")+'\n        <tr>\n            <td class="m-0 p-0">\n                <select name="production_recipe_id[]" class="form-control rounded-0 item-recipe-id recipe">\n                    '.concat(c.replace(/<option /,"<option selected "),'\n                </select>\n            </td>\n            <td class="m-0 p-0">\n                <input min="0" type="number" value="0" step="any" name="production_quantity[]" required class="form-control rounded-0 production-quantity">\n            </td>\n            <td class="m-0 p-0">\n                <input type="text" readonly class="form-control rounded-0 product-name">\n            </td>\n            <td class="m-0 p-0">\n                <input min="0" type="number" value="0" step="any" name="production_usage[]" required readonly class="form-control rounded-0 usage-amount">\n            </td>\n            <td class="m-0 p-0">\n                <input min="0" type="number" value="0" step="any" name="production_export[]" required readonly class="form-control rounded-0 export-amount">\n            </td>\n        </tr>\n    ')},o}(),d=function(){function o(){}return o.calculateBuildings=function(n,t){var e=t.filter((function(o){return 1==o.userRow}));e.pop();for(var i=[],a=function(t){var e=n[t],a=e.recipe;if(null!==a){var r=a.building,u=e.quantity,p=i.find((function(o){return o.buildingId===r.id})),c=u/a.export_amount_per_min,s=0,d=+o.calculateConsumption(c,100,r.power_used);if(c%1!=0&&(s=c%1,c=Math.floor(c)),p?(p.quantity+=c,p.Consumption=+o.calculateConsumption(p.quantity,100,r.power_used)):i.push(new l(r.id,c,100,d,!1,r)),s>0){var v=100*s,m=+o.calculateConsumption(1,v,r.power_used);i.push(new l(r.id,1,+v.toFixed(1),m,!1,r))}}},r=0;r+1<n.length;r++)a(r);i=i.concat(e);var p=s.generatePowerTable(i,u,o.calculateTotalConsumption(i));return $("#power tbody").html(p),i.push(new l),i},o.calculateConsumption=function(o,n,t){return(o*t*Math.pow(n/100,1.321928)).toFixed(1)},o.calculateTotalConsumption=function(o){var n=o.filter((function(o){return 0!==o.Consumption})).reduce((function(o,n){return o+(Number(n.Consumption)||0)}),0);return parseFloat(n.toFixed(3))},o.calculateSingleConsumption=function(o){if(null===o.building)return 0;var n=Math.pow(o.clockSpeed/100,1.321928);return+(o.quantity*o.building.power_used*n).toFixed(1)},o.updateBuilding=function(t,e){return i=this,a=void 0,l=function(){var i;return function(o,n){var t,e,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(u){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(r=0)),r;)try{if(t=1,e&&(i=2&l[0]?e.return:l[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,l[1])).done)return i;switch(e=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,e=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=n.call(o,r)}catch(o){l=[6,o],e=0}finally{t=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}}(this,(function(a){switch(a.label){case 0:return i=t,[4,n.getBuilding(e)];case 1:return i.building=a.sent(),t.buildingId=e,t.Consumption=+o.calculateSingleConsumption(t),[2]}}))},new((r=void 0)||(r=Promise))((function(o,n){function t(o){try{u(l.next(o))}catch(o){n(o)}}function e(o){try{u(l.throw(o))}catch(o){n(o)}}function u(n){var i;n.done?o(n.value):(i=n.value,i instanceof r?i:new r((function(o){o(i)}))).then(t,e)}u((l=l.apply(i,a||[])).next())}));var i,a,r,l},o.updateTotalConsumption=function(n){var t=o.calculateTotalConsumption(n);$("#totalConsumption").val(t)},o}(),v=function(o,n,t){void 0===o&&(o=0),void 0===n&&(n=0),void 0===t&&(t=!1),this.index=o,this.amount=n,this.doubleExport=t},m=function(){function n(){}return n.calculateImports=function(n){for(var t,e=[],i=this.resetUsage(n),a=0;a+1<n.length;a++){var r=n[a],l=null===(t=r.recipe)||void 0===t?void 0:t.resources,u=this.calculateProductionRate(r);l&&this.processRequiredItems(l,u,r,n,e,i)}var p=s.generateImportsTableRows(e);return $("#imports tbody").html(p),e.push(new o),{importsTableRows:e,indexes:i}},n.resetUsage=function(o){for(var n=[],t=0,e=o;t<e.length;t++){var i=e[t];if(i.Usage>0&&(n.push(o.indexOf(i)),i.Usage=0,i.exportPerMin=i.quantity,i.productionImport=[]),null!==i.extraCells&&i.extraCells.Usage>0){var a=o.indexOf(i);-1===a||n.includes(a)||n.push(a),i.extraCells.Usage=0,i.extraCells.ExportPerMin=i.extraCells.Quantity}}return n},n.calculateProductionRate=function(o){var n;return(null===(n=o.recipe)||void 0===n?void 0:n.export_amount_per_min)?o.quantity/o.recipe.export_amount_per_min:0},n.processRequiredItems=function(o,n,t,e,i,a){for(var r=function(o){var r=o.importAmount*n,u=e.filter((function(n){return n.product===o.name})),p=e.filter((function(n){return null!==n.extraCells&&n.extraCells.Product===o.name})),c=0,s=0,d=l.processProducedRows(u,r,s,c,e,a,t);s=d.totalUsed,c=d.totalAvailable;var v=l.processDoubleExportRows(p,r,s,c,e,a,t),m=v.totalUsed;c=v.totalAvailable;var f=r-(s=m);f>0&&l.addToImportsTable(i,o.itemId,f,t)},l=this,u=0,p=o;u<p.length;u++)r(p[u])},n.processProducedRows=function(o,n,t,e,i,a,r){for(var l=0,u=o;l<u.length;l++){var p=u[l],c=p.quantity-p.Usage,s=Math.min(c,n-t);if(!(s<=0)){p.Usage+=+s.toFixed(2),p.exportPerMin=+(p.quantity-p.Usage).toFixed(2),t+=s,e+=c;var d=i.indexOf(p);r.productionImport.push(new v(d,s)),-1===d||a.includes(d)||a.push(d)}}return{totalUsed:t,totalAvailable:e}},n.processDoubleExportRows=function(o,n,t,e,i,a,r){for(var l=0,u=o;l<u.length;l++){var p=u[l];if(null!==p.extraCells){console.log(p.extraCells);var c=p.extraCells.Quantity-p.extraCells.Usage,s=Math.min(c,n-t);if(console.log(s),!(s<=0)){p.extraCells.Usage+=+s.toFixed(2),p.extraCells.ExportPerMin=+(p.extraCells.Quantity-p.extraCells.Usage).toFixed(2),t+=s,e+=c;var d=i.indexOf(p);r.productionImport.push(new v(d,s,!0)),-1===d||a.includes(d)||a.push(d)}}}return{totalUsed:t,totalAvailable:e}},n.addToImportsTable=function(n,t,e,i){var a=n.find((function(o){return o.itemId===t}));a?(a.quantity+=e,i.import=new v(n.indexOf(a),e)):(n.push(new o(t,e)),i.import=new v(n.length-1,e))},n}(),f=function(){function o(){this.autoImportExport=!0,this.autoPowerMachine=!0,this.autoSave=!1,this.addEventListeners(),this.applyChanges()}return o.prototype.applyChanges=function(){var o=new URL(window.location.href),n=parseInt(o.searchParams.get("id")),t=document.getElementById("auto_import_export"),e=document.getElementById("auto_power_machine");t&&(this.autoImportExport=t.checked),e&&(this.autoPowerMachine=e.checked),this.saveSettings(n)},o.prototype.addEventListeners=function(){var o=this,n=document.getElementById("auto_import_export"),t=document.getElementById("auto_power_machine");n&&n.addEventListener("change",(function(){$("#auto_import_export").parent().parent().tooltip("hide"),o.applyChanges()})),t&&t.addEventListener("change",(function(){$("#auto_power_machine").parent().parent().tooltip("hide"),o.applyChanges()}))},o.prototype.saveSettings=function(o){$.ajax({type:"POST",url:"updateProductionLineSettings",data:{productionLineId:o,autoImportExport:this.autoImportExport,autoPowerMachine:this.autoPowerMachine,autoSave:this.autoSave}})},o}(),h=function(o,n,t,e){return new(t||(t=Promise))((function(i,a){function r(o){try{u(e.next(o))}catch(o){a(o)}}function l(o){try{u(e.throw(o))}catch(o){a(o)}}function u(o){var n;o.done?i(o.value):(n=o.value,n instanceof t?n:new t((function(o){o(n)}))).then(r,l)}u((e=e.apply(o,n||[])).next())}))},y=function(o,n){var t,e,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(u){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(r=0)),r;)try{if(t=1,e&&(i=2&l[0]?e.return:l[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,l[1])).done)return i;switch(e=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,e=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=n.call(o,r)}catch(o){l=[6,o],e=0}finally{t=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}},w=function(){function n(){this.settings=new f,this.importsTableRows=this.readTable("imports",o),this.productionTableRows=this.readTable("recipes",r),this.powerTableRows=this.readTable("power",l),this.addEventListeners()}return n.prototype.readTable=function(o,n){var e,i=$("#".concat(o," tbody tr")),a=[],r=0;"power"===o&&(r=1);for(var l,u=function(r){var u=i[r],p=$(u).find("input, select"),c=[];if(p.each((function(o,n){"number"===$(n).attr("type")?c.push(Number($(n).val())):c.push($(n).val())})),"recipes"===o&&(null===(e=i[r+1])||void 0===e?void 0:e.classList.contains("extra-output"))){var s=i[r+1],d=$(s).find("input, select").map((function(o,n){return $(n).val()})).get(),v=new t(d[0],Number(d[1]),Number(d[2]));c.push(!0,v),r++}a.push(new(n.bind.apply(n,function(o,n,t){if(t||2===arguments.length)for(var e,i=0,a=n.length;i<a;i++)!e&&i in n||(e||(e=Array.prototype.slice.call(n,0,i)),e[i]=n[i]);return o.concat(e||Array.prototype.slice.call(n))}([void 0],c,!1)))),l=r},p=0;p<i.length-r;p++)u(p),p=l;return a},n.prototype.addEventListeners=function(){var o=this;["imports","recipes","power"].forEach((function(n){$("#".concat(n," tbody")).find("input, select").each((function(t,e){$(e).on("change",(function(t){o.handleInputChange(t,n)}))}))}))},n.prototype.addSpecificEventListener=function(o){var n=this;$("#".concat(o," tbody")).find("input, select").each((function(t,e){$(e).on("change",(function(t){n.handleInputChange(t,o)}))}))},n.prototype.handleInputChange=function(o,n){return h(this,void 0,void 0,(function(){var t,e,i,a,r,l;return y(this,(function(u){switch(u.label){case 0:if(t=$(o.target),e=t.closest("tr").index(),i=t.closest("tr").prevAll(".extra-output").length,a=t.closest("td").index(),r=t.val(),this.checkIfLastRow(t,n)&&this.checkIfSelect(t)&&this.addNewRow(n),!((l=this.getRowByTableIdAndIndex(n,e-i))&&a>=0))return[3,7];switch(this.updateRowData(l,a,r),n){case"imports":return[3,1];case"recipes":return[3,2];case"power":return[3,4]}return[3,6];case 1:case 6:return[3,7];case 2:return[4,this.HandleProductionTable(l,e,r,n,t)];case 3:case 5:return u.sent(),[3,7];case 4:return[4,this.HandlePowerTable(l,e,r,n,t)];case 7:return[2]}}))}))},n.prototype.getRowByTableIdAndIndex=function(o,n){switch(o){case"imports":return this.importsTableRows[n];case"recipes":return this.productionTableRows[n];case"power":return this.powerTableRows[n];default:return null}},n.prototype.updateRowData=function(o,n,t){o[Object.keys(o)[n]]=t},n.prototype.updateRowInTable=function(o,n,t){var e=$("#".concat(o," tbody tr")),i=$(e[n]);i.find("input, select").each((function(o,n){var e,i=Object.keys(t)[o];e=t.recipe&&t.recipe.hasOwnProperty(i)?t.recipe[i]:t[i],$(n).val(e)})),"recipes"===o&&a.handleDoubleExport(t,i)},n.prototype.addNewRow=function(n){var t,e=this,i=(t="power"===n?$("#".concat(n," tbody tr:nth-last-child(2)")):$("#".concat(n," tbody tr:last"))).clone();switch(i.find('input[type="number"]').val(0),i.find('input[type="text"]').val(""),i.find('input[name="power_clock_speed[]"]').val(100),i.find("select").prop("selectedIndex",0),i.insertAfter(t),i.find("input, select").each((function(o,t){$(t).on("change",(function(o){e.handleInputChange(o,n)}))})),n){case"imports":this.importsTableRows.push(new o);break;case"recipes":this.productionTableRows.push(new r);break;case"power":this.powerTableRows.push(new l)}},n.prototype.checkIfLastRow=function(o,n){return"power"===n?o.closest("tr").is(":nth-last-child(2)"):o.closest("tr").is(":last-child")},n.prototype.checkIfSelect=function(o){return o.is("select")},n.prototype.UpdateOnIndex=function(o){for(var n=0;n<o.length;n++){var t=o[n],e=(this.productionTableRows[t],this.productionTableRows.slice(0,t).filter((function(o){return o.doubleExport})).length),i=this.productionTableRows[t];this.updateRowInTable("recipes",t+e,i)}},n.prototype.HandlePowerTable=function(o,n,t,e,i){return h(this,void 0,void 0,(function(){return y(this,(function(a){switch(a.label){case 0:return this.checkIfSelect(i)?[4,d.updateBuilding(o,t)]:[3,2];case 1:return a.sent(),[3,3];case 2:o.Consumption=d.calculateSingleConsumption(o),a.label=3;case 3:return this.updateRowInTable(e,n,o),d.updateTotalConsumption(this.powerTableRows),[2]}}))}))},n.prototype.HandleProductionTable=function(o,n,t,e,i){return h(this,void 0,void 0,(function(){var r;return y(this,(function(l){switch(l.label){case 0:return[4,a.calculateProductionExport(o)];case 1:return l.sent(),this.checkIfSelect(i)?[4,a.updateRecipe(o,t)]:[3,3];case 2:l.sent(),l.label=3;case 3:return this.updateRowInTable(e,n,o),this.settings.autoImportExport&&(r=m.calculateImports(this.productionTableRows),this.importsTableRows=r.importsTableRows,this.UpdateOnIndex(r.indexes)),this.settings.autoPowerMachine&&(this.powerTableRows=d.calculateBuildings(this.productionTableRows,this.powerTableRows),this.addSpecificEventListener("power")),console.log(this),[2]}}))}))},n.prototype.saveData=function(n,t,e){this.productionTableRows=(n.pop(),n),this.powerTableRows=(t.pop(),t),this.importsTableRows=(e.pop(),e),this.generateTables(),this.powerTableRows.push(new l),this.productionTableRows.push(new r),this.importsTableRows.push(new o)},n.prototype.generateTables=function(){$("#power tbody").html(s.generatePowerTable(this.powerTableRows,u,d.calculateTotalConsumption(this.powerTableRows))),$("#imports tbody").html(s.generateImportsTableRows(this.importsTableRows)),$("#recipes tbody").html(s.generateProductionTableRows(this.productionTableRows)),this.addEventListeners()},n}(),b=function(){function o(){}return o.prepareSaveData=function(o,n,t){return{productionTableRows:o,powerTableRows:n,importsTableRows:t}},o.saveProductionLine=function(o){var t=this;try{var e=new URL(window.location.href),i=parseInt(e.searchParams.get("id"));n.saveData(o,i).then((function(o){o.success?t.showSuccessMessage("Data successfully saved."):t.showErrorMessage("An error occurred while saving the data. Please try again.")})).catch((function(o){t.showErrorMessage("An error occurred while saving the data. Please try again.")}))}catch(o){this.showErrorMessage("An error occurred while saving the data. Please try again.")}},o.showSuccessMessage=function(o){this.showMessage("saveSuccessAlert",o)},o.showErrorMessage=function(o){this.showMessage("saveErrorAlert",o)},o.showMessage=function(o,n){var t=document.getElementById(o);t&&(t.textContent=n,t.classList.add("d-none"),t.classList.remove("show"),t.offsetWidth,t.classList.remove("d-none"),t.classList.add("show"),setTimeout((function(){t.classList.remove("show"),setTimeout((function(){t.classList.add("d-none")}),150)}),5e3))},o}(),g=function(){function o(){}return o.importData=function(o){return n=this,t=void 0,i=function(){var n,t,e=this;return function(o,n){var t,e,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(u){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(r=0)),r;)try{if(t=1,e&&(i=2&l[0]?e.return:l[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,l[1])).done)return i;switch(e=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,e=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=n.call(o,r)}catch(o){l=[6,o],e=0}finally{t=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}}(this,(function(i){return this.checkIfFileIsSelected()&&this.checkIfFileIsJson()?(n=$("#importFile").prop("files")[0],(t=new FileReader).readAsText(n),t.onload=function(n){var t,i=JSON.parse(null===(t=n.target)||void 0===t?void 0:t.result);i.productionTable&&i.powerTable&&i.importTable?(o.saveData(i.productionTable,i.powerTable,i.importTable),e.showSuccessMessage("Data successfully imported.")):e.showErrorMessage("The selected file does not contain the required data.")},[2]):[2]}))},new((e=void 0)||(e=Promise))((function(o,a){function r(o){try{u(i.next(o))}catch(o){a(o)}}function l(o){try{u(i.throw(o))}catch(o){a(o)}}function u(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(o){o(t)}))).then(r,l)}u((i=i.apply(n,t||[])).next())}));var n,t,e,i},o.exportData=function(o){var n=o.productionTableRows,t=o.importsTableRows,e={productionTable:n,powerTable:o.powerTableRows,importTable:t},i=(new TextEncoder).encode(JSON.stringify(e)),a=new Blob([i],{type:"application/json"}),r=URL.createObjectURL(a),l=document.createElement("a");l.href=r,l.download=this.generateFileName(),l.click(),URL.revokeObjectURL(r),this.showSuccessMessage("Data successfully exported.")},o.checkIfFileIsSelected=function(){var o,n=document.getElementById("importFile");if(!(null===(o=n.files)||void 0===o?void 0:o.length)){n.classList.add("is-invalid");var t=n.nextElementSibling;return t&&t.classList.add("d-block"),!1}n.classList.remove("is-invalid");var e=n.nextElementSibling;return e&&e.classList.remove("d-block"),!0},o.checkIfFileIsJson=function(){var o,n=document.getElementById("importFile"),t=null===(o=n.files)||void 0===o?void 0:o[0];if(t&&"application/json"!==t.type){n.classList.add("is-invalid");var e=n.nextElementSibling;return e&&(e.textContent="Please select a valid JSON file.",e.classList.add("d-block")),!1}return!0},o.showMessage=function(o,n){var t=document.getElementById(o);t&&(t.textContent=n,t.classList.add("d-none"),t.classList.remove("show"),t.offsetWidth,t.classList.remove("d-none"),t.classList.add("show"),setTimeout((function(){t.classList.remove("show"),setTimeout((function(){t.classList.add("d-none")}),150)}),5e3))},o.showSuccessMessage=function(o,n){void 0===n&&(n=1),1!==n||this.showMessage("successAlert",o)},o.showErrorMessage=function(o,n){void 0===n&&(n=1),1!==n||this.showMessage("errorAlert",o)},o.generateFileName=function(){var o=Intl.DateTimeFormat().resolvedOptions().timeZone,n=(new Date).toLocaleString("en-GB",{timeZone:o}).replace(/[\/\s,:]/g,"_"),t=$("#productionLineName").text().replace("Production Line - ","");return t=t.replace(/\s/g,"_"),"".concat(t,"_data_").concat(n,".json")},o}(),C=new w,A=$("#save_button");A.on("click",(function(o){o.shiftKey&&(o.preventDefault(),b.saveProductionLine(b.prepareSaveData(C.productionTableRows,C.powerTableRows,C.importsTableRows)),A.tooltip("hide"),A.blur())}));var S=$("#exportButton"),x=$("#importButton");return S.on("click",(function(){g.exportData(C)})),x.on("click",(function(o){o.preventDefault(),g.importData(C)})),{}})()));