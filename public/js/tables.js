!function(o,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.tables=t():o.tables=t()}(this,(()=>(()=>{"use strict";var o=function(o,t,n){void 0===o&&(o=0),void 0===t&&(t=0),void 0===n&&(n=""),this.itemId=o,this.quantity=t,this.product=n},t=function(){function o(){}return o.getRecipe=function(o){return new Promise((function(t,n){$.ajax({type:"GET",url:"getRecipe",data:{id:o},dataType:"json",success:function(o){try{t(o)}catch(o){n(o)}},error:function(o,t,e){n(e)}})}))},o.getBuilding=function(o){return new Promise((function(t,n){$.ajax({type:"GET",url:"getBuilding",data:{id:o},dataType:"json",success:function(o){try{t(o)}catch(o){n(o)}},error:function(o,t,e){n(e)}})}))},o.saveData=function(o,t){return n=this,e=void 0,a=function(){return function(o,t){var n,e,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(u){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(r=0)),r;)try{if(n=1,e&&(i=2&l[0]?e.return:l[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,l[1])).done)return i;switch(e=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,e=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(o,r)}catch(o){l=[6,o],e=0}finally{n=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}}(this,(function(n){return[2,new Promise((function(n,e){$.ajax({type:"POST",url:"saveProductionLine",data:{data:JSON.stringify(o),id:t},success:function(o){n(JSON.parse(o))},error:function(o,t,n){e(n)}})}))]}))},new((i=void 0)||(i=Promise))((function(o,t){function r(o){try{u(a.next(o))}catch(o){t(o)}}function l(o){try{u(a.throw(o))}catch(o){t(o)}}function u(t){var n;t.done?o(t.value):(n=t.value,n instanceof i?n:new i((function(o){o(n)}))).then(r,l)}u((a=a.apply(n,e||[])).next())}));var n,e,i,a},o}(),n=function(o,t,n,e){void 0===o&&(o=""),void 0===t&&(t=0),void 0===n&&(n=0),void 0===e&&(e=0),this.Product=o,this.Usage=t,this.ExportPerMin=n,this.Quantity=e},e=function(o,t,n,e){return new(n||(n=Promise))((function(i,a){function r(o){try{u(e.next(o))}catch(o){a(o)}}function l(o){try{u(e.throw(o))}catch(o){a(o)}}function u(o){var t;o.done?i(o.value):(t=o.value,t instanceof n?t:new n((function(o){o(t)}))).then(r,l)}u((e=e.apply(o,t||[])).next())}))},i=function(o,t){var n,e,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(u){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(r=0)),r;)try{if(n=1,e&&(i=2&l[0]?e.return:l[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,l[1])).done)return i;switch(e=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,e=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(o,r)}catch(o){l=[6,o],e=0}finally{n=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}},a=function(){function o(){}return o.calculateProductionExport=function(o){return e(this,void 0,void 0,(function(){var t;return i(this,(function(n){return o.exportPerMin=o.quantity-o.Usage,o.doubleExport&&null!==o.recipe&&void 0!==(t=this.calculateSecondExportPerMin(o))&&(o.extraCells.Quantity=t,o.extraCells.ExportPerMin=t),[2]}))}))},o.updateRecipe=function(o,t){return e(this,void 0,void 0,(function(){var e,a,r,l,u;return i(this,(function(i){switch(i.label){case 0:return[4,this.saveRecipe(t,o)];case 1:return i.sent(),null===(e=o.recipe)||(o.recipeId=e.id,o.product=e.itemName,o.doubleExport=null!==e.secondItemName,o.doubleExport&&(a=+e.export_amount_per_min,r=+e.export_amount_per_min2,l=r/a,u=o.quantity,o.extraCells=new n(e.secondItemName,0,u*l))),[2]}}))}))},o.saveRecipe=function(o,n){return e(this,void 0,void 0,(function(){var e;return i(this,(function(i){switch(i.label){case 0:return e=n,[4,t.getRecipe(+o)];case 1:return e.recipe=i.sent(),[2]}}))}))},o.handleDoubleExport=function(o,t){if(o.doubleExport&&null!==o.extraCells)if(t.next(".extra-output").length){var n=(i=t.next(".extra-output")).find('input[name="production_usage2[]"]'),e=i.find('input[name="production_export2[]"]');n.val(o.extraCells.Usage),e.val(o.extraCells.ExportPerMin)}else{var i;t.find("td:first").attr("rowspan",2),t.find("td:nth-child(2)").attr("rowspan",2),t.find("td:first select").css("height","78px"),t.find("td:nth-child(2) input").css("height","78px"),(i=$('\n                    <tr class="extra-output">\n                        <td class="m-0 p-0">\n                            <input type="text" name="product" value="'.concat(o.extraCells.Product,'" class="form-control rounded-0" readonly>\n                        </td>\n                        <td class="m-0 p-0">\n                            <input type="number" name="production_usage2[]" value="').concat(o.extraCells.Usage,'" class="form-control rounded-0" readonly step="any">\n                        </td>\n                        <td class="m-0 p-0">\n                            <input type="number" name="production_export2[]" value="').concat(o.extraCells.ExportPerMin,'" class="form-control rounded-0" readonly step="any">\n                        </td>\n                    </tr>\n                '))).insertAfter(t)}else t.next(".extra-output").length&&(t.next(".extra-output").remove(),t.find("td:first").removeAttr("rowspan"),t.find("td:nth-child(2)").removeAttr("rowspan"),t.find("td:first select").css("height",""),t.find("td:nth-child(2) input").css("height",""))},o.calculateSecondExportPerMin=function(o){if(null!==o.recipe){var t=o.recipe.export_amount_per_min2,n=o.recipe.export_amount_per_min;if(null!==t&&null!==n){var e=t/n;return o.quantity*e}}},o}(),r=function(){function o(o,t,n,e,i,a,r){void 0===o&&(o=""),void 0===t&&(t=0),void 0===n&&(n=""),void 0===e&&(e=0),void 0===i&&(i=0),void 0===a&&(a=!1),void 0===r&&(r=null);var l=this;this.recipeId=+o,this.quantity=t,this.product=n,this.Usage=e,this.exportPerMin=i,this.doubleExport=a,this.extraCells=r,this.recipe=null,this.imports=[],this.productionImports=[],this.getRecipe(o).then((function(o){return l.saveDoubleExportQuantity()}))}return o.prototype.getRecipe=function(o){return n=this,e=void 0,a=function(){var n;return function(o,t){var n,e,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(u){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(r=0)),r;)try{if(n=1,e&&(i=2&l[0]?e.return:l[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,l[1])).done)return i;switch(e=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,e=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(o,r)}catch(o){l=[6,o],e=0}finally{n=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}}(this,(function(e){switch(e.label){case 0:return n=this,[4,t.getRecipe(+o)];case 1:return n.recipe=e.sent(),[2]}}))},new((i=void 0)||(i=Promise))((function(o,t){function r(o){try{u(a.next(o))}catch(o){t(o)}}function l(o){try{u(a.throw(o))}catch(o){t(o)}}function u(t){var n;t.done?o(t.value):(n=t.value,n instanceof i?n:new i((function(o){o(n)}))).then(r,l)}u((a=a.apply(n,e||[])).next())}));var n,e,i,a},o.prototype.saveDoubleExportQuantity=function(){this.doubleExport&&null!==this.extraCells&&(this.extraCells.Quantity=a.calculateSecondExportPerMin(this))},o}(),l=function(o,n,e,i,a,r){void 0===o&&(o=NaN),void 0===n&&(n=0),void 0===e&&(e=100),void 0===i&&(i=0),void 0===a&&(a=!0),void 0===r&&(r=null);var l=this;this.buildingId=o,this.quantity=n,this.clockSpeed=e,this.Consumption=i,this.userRow=a,this.building=r,isNaN(o)||null===o||null!==r||t.getBuilding(o).then((function(o){l.building=o}))},u='\n  <option value="" disabled>Select a building</option>\n  <option value="16">Assembler</option>\n  <option value="17">Blender</option>\n  <option value="19">Constructor</option>\n  <option value="6">Converter</option>\n  <option value="13">Foundry</option>\n  <option value="21">Main Portal</option>\n  <option value="15">Manufacturer</option>\n  <option value="10">Miner Mk.1</option>\n  <option value="9">Miner Mk.2</option>\n  <option value="11">Miner Mk.3</option>\n  <option value="8">Oil Extractor</option>\n  <option value="14">Packager</option>\n  <option value="7">Particle Accelerator</option>\n  <option value="5">Quantum Encoder</option>\n  <option value="12">Refinery</option>\n  <option value="22">Satellite Portal</option>\n  <option value="18">Smelter</option>\n  <option value="4">Water Extractor</option>\n',p='\n<option value="" disabled>Select an item</option>\n<option value="111">Actual Snow</option>\n<option value="82">Adaptive Control Unit</option>\n<option value="48">AI Expansion Server</option>\n<option value="79">AI Limiter</option>\n<option value="45">Alclad Aluminum Sheet</option>\n<option value="102">Alien DNA Capsule</option>\n<option value="100">Alien Protein</option>\n<option value="72">Alumina Solution</option>\n<option value="71">Aluminum Casing</option>\n<option value="7">Aluminum Ingot</option>\n<option value="70">Aluminum Scrap</option>\n<option value="56">Assembly Director System</option>\n<option value="77">Automated Wiring</option>\n<option value="98">Ballistic Warp Drive</option>\n<option value="8">Battery</option>\n<option value="128">Bauxite</option>\n<option value="55">Biochemical Sculptor</option>\n<option value="137">Biomass</option>\n<option value="95">Black Powder</option>\n<option value="117">Blue FICSMAS Ornament</option>\n<option value="101">Blue Power Slug</option>\n<option value="20">Cable</option>\n<option value="110">Candy Cane</option>\n<option value="57">Caterium Ingot</option>\n<option value="129">Caterium Ore</option>\n<option value="59">Circuit Board</option>\n<option value="123">Coal</option>\n<option value="14">Compacted Coal</option>\n<option value="73">Computer</option>\n<option value="3">Concrete</option>\n<option value="37">Cooling System</option>\n<option value="113">Copper FICSMAS Ornament</option>\n<option value="69">Copper Ingot</option>\n<option value="130">Copper Ore</option>\n<option value="88">Copper Powder</option>\n<option value="26">Copper Sheet</option>\n<option value="134">Crude Oil</option>\n<option value="32">Crystal Oscillator</option>\n<option value="34">Dark Matter Crystal</option>\n<option value="41">Dark Matter Residue</option>\n<option value="44">Diamonds</option>\n<option value="93">Dissolved Silica</option>\n<option value="90">Electromagnetic Control Rod</option>\n<option value="58">Empty Canister</option>\n<option value="31">Empty Fluid Tank</option>\n<option value="61">Encased Industrial Beam</option>\n<option value="84">Encased Plutonium Cell</option>\n<option value="92">Encased Uranium Cell</option>\n<option value="43">Excited Photonic Matter</option>\n<option value="146">Fabric</option>\n<option value="54">Ficsite Ingot</option>\n<option value="38">Ficsite Trigon</option>\n<option value="112">FICSMAS Bow</option>\n<option value="109">FICSMAS Decoration</option>\n<option value="118">FICSMAS Gift</option>\n<option value="108">FICSMAS Ornament Bundle</option>\n<option value="115">FICSMAS Tree Branch</option>\n<option value="107">FICSMAS Wonder Star</option>\n<option value="96">Ficsonium</option>\n<option value="121">Ficsonium Fuel Rod</option>\n<option value="24">Fuel</option>\n<option value="52">Fused Modular Frame</option>\n<option value="99">Gas Filter</option>\n<option value="150">Hatcher Remains</option>\n<option value="89">Heat Sink</option>\n<option value="74">Heavy Modular Frame</option>\n<option value="64">Heavy Oil Residue</option>\n<option value="76">High-Speed Connector</option>\n<option value="147">Hog Remains</option>\n<option value="13">Iodine-Infused Filter</option>\n<option value="35">Ionized Fuel</option>\n<option value="114">Iron FICSMAS Ornament</option>\n<option value="21">Iron Ingot</option>\n<option value="122">Iron Ore</option>\n<option value="5">Iron Plate</option>\n<option value="18">Iron Rod</option>\n<option value="138">Leaves</option>\n<option value="132">Limestone</option>\n<option value="141">Liquid Biofuel</option>\n<option value="49">Magnetic Field Generator</option>\n<option value="103">Mercer Sphere</option>\n<option value="81">Modular Engine</option>\n<option value="27">Modular Frame</option>\n<option value="33">Motor</option>\n<option value="139">Mycelia</option>\n<option value="47">Neural-Quantum Processor</option>\n<option value="29">Nitric Acid</option>\n<option value="125">Nitrogen Gas</option>\n<option value="86">Non-Fissile Uranium</option>\n<option value="91">Nuclear Pasta</option>\n<option value="142">Packaged Alumina Solution</option>\n<option value="9">Packaged Fuel</option>\n<option value="15">Packaged Heavy Oil Residue</option>\n<option value="10">Packaged Ionized Fuel</option>\n<option value="136">Packaged Liquid Biofuel</option>\n<option value="144">Packaged Nitric Acid</option>\n<option value="143">Packaged Nitrogen Gas</option>\n<option value="17">Packaged Oil</option>\n<option value="11">Packaged Rocket Fuel</option>\n<option value="145">Packaged Sulfuric Acid</option>\n<option value="12">Packaged Turbofuel</option>\n<option value="68">Packaged Water</option>\n<option value="16">Petroleum Coke</option>\n<option value="60">Plastic</option>\n<option value="120">Plutonium Fuel Rod</option>\n<option value="85">Plutonium Pellet</option>\n<option value="2">Plutonium Waste</option>\n<option value="63">Polymer Resin</option>\n<option value="83">Pressure Conversion Cube</option>\n<option value="104">Purple Power Slug</option>\n<option value="65">Quartz Crystal</option>\n<option value="80">Quickwire</option>\n<option value="53">Radio Control Unit</option>\n<option value="131">Raw Quartz</option>\n<option value="42">Reanimated SAM</option>\n<option value="116">Red FICSMAS Ornament</option>\n<option value="22">Reinforced Iron Plate</option>\n<option value="25">Rocket Fuel</option>\n<option value="23">Rotor</option>\n<option value="62">Rubber</option>\n<option value="127">SAM</option>\n<option value="50">SAM Fluctuator</option>\n<option value="28">Screw</option>\n<option value="4">Silica</option>\n<option value="97">Singularity Cell</option>\n<option value="75">Smart Plating</option>\n<option value="106">Smokeless Powder</option>\n<option value="135">Solid Biofuel</option>\n<option value="148">Spitter Remains</option>\n<option value="78">Stator</option>\n<option value="6">Steel Beam</option>\n<option value="66">Steel Ingot</option>\n<option value="51">Steel Pipe</option>\n<option value="149">Stinger Remains</option>\n<option value="126">Sulfur</option>\n<option value="87">Sulfuric Acid</option>\n<option value="36">Supercomputer</option>\n<option value="46">Superposition Oscillator</option>\n<option value="94">Thermal Propulsion Rocket</option>\n<option value="40">Time Crystal</option>\n<option value="39">Turbo Motor</option>\n<option value="30">Turbofuel</option>\n<option value="133">Uranium</option>\n<option value="119">Uranium Fuel Rod</option>\n<option value="1">Uranium Waste</option>\n<option value="67">Versatile Framework</option>\n<option value="124">Water</option>\n<option value="19">Wire</option>\n<option value="140">Wood</option>\n<option value="105">Yellow Power Slug</option>\n',s='\n    <option value="" disabled>Select a recipe</option>\n    <option value="259">Actual Snow</option>\n    <option value="116">Adaptive Control Unit</option>\n    <option value="14">AI Expansion Server</option>\n    <option value="110">AI Limiter</option>\n    <option value="95">Alclad Aluminum Sheet</option>\n    <option value="245">Alien DNA Capsule</option>\n    <option value="242">Alien Power Matrix</option>\n    <option value="133">Alternate: Adhered Iron Plate</option>\n    <option value="177">Alternate: Alclad Casing</option>\n    <option value="182">Alternate: Aluminum Beam</option>\n    <option value="183">Alternate: Aluminum Rod</option>\n    <option value="105">Alternate: Automated Speed Wiring</option>\n    <option value="189">Alternate: Basic Iron Ingot</option>\n    <option value="49">Alternate: Biocoal</option>\n    <option value="132">Alternate: Bolted Frame</option>\n    <option value="208">Alternate: Bolted Iron Plate</option>\n    <option value="204">Alternate: Cast Screw</option>\n    <option value="227">Alternate: Caterium Circuit Board</option>\n    <option value="226">Alternate: Caterium Computer</option>\n    <option value="194">Alternate: Caterium Wire</option>\n    <option value="48">Alternate: Charcoal</option>\n    <option value="202">Alternate: Cheap Silica</option>\n    <option value="176">Alternate: Classic Battery</option>\n    <option value="62">Alternate: Cloudy Diamonds</option>\n    <option value="131">Alternate: Coated Cable</option>\n    <option value="130">Alternate: Coated Iron Canister</option>\n    <option value="129">Alternate: Coated Iron Plate</option>\n    <option value="128">Alternate: Coke Steel Ingot</option>\n    <option value="50">Alternate: Compacted Coal</option>\n    <option value="215">Alternate: Compacted Steel Ingot</option>\n    <option value="175">Alternate: Cooling Device</option>\n    <option value="127">Alternate: Copper Alloy Ingot</option>\n    <option value="122">Alternate: Copper Rotor</option>\n    <option value="225">Alternate: Crystal Computer</option>\n    <option value="64">Alternate: Dark Matter Crystallization</option>\n    <option value="63">Alternate: Dark Matter Trap</option>\n    <option value="8">Alternate: Dark-Ion Fuel</option>\n    <option value="174">Alternate: Diluted Fuel</option>\n    <option value="121">Alternate: Diluted Packaged Fuel</option>\n    <option value="185">Alternate: Distilled Silica</option>\n    <option value="173">Alternate: Electric Motor</option>\n    <option value="120">Alternate: Electrode Aluminum Scrap</option>\n    <option value="119">Alternate: Electrode Circuit Board</option>\n    <option value="222">Alternate: Electromagnetic Connection Rod</option>\n    <option value="206">Alternate: Encased Industrial Pipe</option>\n    <option value="172">Alternate: Fertile Uranium</option>\n    <option value="221">Alternate: Fine Black Powder</option>\n    <option value="224">Alternate: Fine Concrete</option>\n    <option value="118">Alternate: Flexible Framework</option>\n    <option value="187">Alternate: Fused Quartz Crystal</option>\n    <option value="210">Alternate: Fused Quickwire</option>\n    <option value="117">Alternate: Fused Wire</option>\n    <option value="220">Alternate: Heat Exchanger</option>\n    <option value="171">Alternate: Heat-Fused Frame</option>\n    <option value="219">Alternate: Heavy Encased Frame</option>\n    <option value="112">Alternate: Heavy Flexible Frame</option>\n    <option value="111">Alternate: Heavy Oil Residue</option>\n    <option value="196">Alternate: Infused Uranium Cell</option>\n    <option value="170">Alternate: Instant Plutonium Cell</option>\n    <option value="169">Alternate: Instant Scrap</option>\n    <option value="230">Alternate: Insulated Cable</option>\n    <option value="223">Alternate: Insulated Crystal Oscillator</option>\n    <option value="217">Alternate: Iron Alloy Ingot</option>\n    <option value="179">Alternate: Iron Pipe</option>\n    <option value="195">Alternate: Iron Wire</option>\n    <option value="193">Alternate: Leached Caterium Ingot</option>\n    <option value="191">Alternate: Leached Copper Ingot</option>\n    <option value="188">Alternate: Leached Iron ingot</option>\n    <option value="181">Alternate: Molded Beam</option>\n    <option value="178">Alternate: Molded Steel Pipe</option>\n    <option value="4">Alternate: Nitro Rocket Fuel</option>\n    <option value="163">Alternate: OC Supercomputer</option>\n    <option value="61">Alternate: Oil-Based Diamonds</option>\n    <option value="60">Alternate: Petroleum Diamonds</option>\n    <option value="59">Alternate: Pink Diamonds</option>\n    <option value="184">Alternate: Plastic AI Limiter</option>\n    <option value="104">Alternate: Plastic Smart Plating</option>\n    <option value="162">Alternate: Plutonium Fuel Unit</option>\n    <option value="248">Alternate: Polyester Fabric</option>\n    <option value="103">Alternate: Polymer Resin</option>\n    <option value="93">Alternate: Pure Aluminum Ingot</option>\n    <option value="92">Alternate: Pure Caterium Ingot</option>\n    <option value="91">Alternate: Pure Copper Ingot</option>\n    <option value="90">Alternate: Pure Iron Ingot</option>\n    <option value="88">Alternate: Pure Quartz Crystal</option>\n    <option value="186">Alternate: Quartz Purification</option>\n    <option value="229">Alternate: Quickwire Cable</option>\n    <option value="201">Alternate: Quickwire Stator</option>\n    <option value="209">Alternate: Radio Connection Unit</option>\n    <option value="161">Alternate: Radio Control System</option>\n    <option value="211">Alternate: Recycled Plastic</option>\n    <option value="87">Alternate: Recycled Rubber</option>\n    <option value="213">Alternate: Rigor Motor</option>\n    <option value="86">Alternate: Rubber Concrete</option>\n    <option value="228">Alternate: Silicon Circuit Board</option>\n    <option value="218">Alternate: Silicon High-Speed Connector</option>\n    <option value="160">Alternate: Sloppy Alumina</option>\n    <option value="216">Alternate: Solid Steel Ingot</option>\n    <option value="85">Alternate: Steamed Copper Sheet</option>\n    <option value="72">Alternate: Steel Canister</option>\n    <option value="180">Alternate: Steel Cast Plate</option>\n    <option value="67">Alternate: Steel Rod</option>\n    <option value="205">Alternate: Steel Rotor</option>\n    <option value="203">Alternate: Steel Screw</option>\n    <option value="214">Alternate: Steeled Frame</option>\n    <option value="207">Alternate: Stitched Iron Plate</option>\n    <option value="156">Alternate: Super-State Computer</option>\n    <option value="192">Alternate: Tempered Caterium Ingot</option>\n    <option value="190">Alternate: Tempered Copper Ingot</option>\n    <option value="145">Alternate: Turbo Blend Fuel</option>\n    <option value="18">Alternate: Turbo Diamonds</option>\n    <option value="198">Alternate: Turbo Electric Motor</option>\n    <option value="66">Alternate: Turbo Heavy Fuel</option>\n    <option value="134">Alternate: Turbo Pressure Motor</option>\n    <option value="212">Alternate: Uranium Fuel Unit</option>\n    <option value="65">Alternate: Wet Concrete</option>\n    <option value="96">Alumina Solution</option>\n    <option value="94">Aluminum Casing</option>\n    <option value="99">Aluminum Ingot</option>\n    <option value="97">Aluminum Scrap</option>\n    <option value="153">Assembly Director System</option>\n    <option value="109">Automated Wiring</option>\n    <option value="234">Ballistic Warp Drive</option>\n    <option value="148">Battery</option>\n    <option value="28">Bauxite (Caterium)</option>\n    <option value="29">Bauxite (Copper)</option>\n    <option value="25">Biochemical Sculptor</option>\n    <option value="240">Biomass (Mycelia)</option>\n    <option value="246">Biomass (Alien Protein)</option>\n    <option value="263">Biomass (Leaves)</option>\n    <option value="264">Biomass (Wood)</option>\n    <option value="241">Black Powder</option>\n    <option value="256">Blue FICSMAS Ornament</option>\n    <option value="268">Cable</option>\n    <option value="262">Candy Cane</option>\n    <option value="197">Caterium Ingot</option>\n    <option value="30">Caterium Ore (Copper)</option>\n    <option value="31">Caterium Ore (Quartz)</option>\n    <option value="51">Circuit Board</option>\n    <option value="32">Coal (Iron)</option>\n    <option value="33">Coal (Limestone)</option>\n    <option value="113">Computer</option>\n    <option value="266">Concrete</option>\n    <option value="147">Cooling System</option>\n    <option value="257">Copper FICSMAS Ornament</option>\n    <option value="270">Copper Ingot</option>\n    <option value="34">Copper Ore (Quartz)</option>\n    <option value="35">Copper Ore (Sulfur)</option>\n    <option value="139">Copper Powder</option>\n    <option value="125">Copper Sheet</option>\n    <option value="101">Crystal Oscillator</option>\n    <option value="11">Dark Matter Crystal</option>\n    <option value="9">Dark Matter Residue</option>\n    <option value="23">Diamonds</option>\n    <option value="157">Electromagnetic Control Rod</option>\n    <option value="73">Empty Canister</option>\n    <option value="166">Empty Fluid Tank</option>\n    <option value="106">Encased Industrial Beam</option>\n    <option value="135">Encased Plutonium Cell</option>\n    <option value="146">Encased Uranium Cell</option>\n    <option value="10">Excited Photonic Matter</option>\n    <option value="249">Fabric</option>\n    <option value="21">Ficsite Ingot (Iron)</option>\n    <option value="26">Ficsite Ingot (Aluminum)</option>\n    <option value="27">Ficsite Ingot (Caterium)</option>\n    <option value="20">Ficsite Trigon</option>\n    <option value="261">FICSMAS Bow</option>\n    <option value="253">FICSMAS Decoration</option>\n    <option value="254">FICSMAS Ornament Bundle</option>\n    <option value="260">FICSMAS Tree Branch</option>\n    <option value="252">FICSMAS Wonder Star</option>\n    <option value="231">Ficsonium</option>\n    <option value="232">Ficsonium Fuel Rod</option>\n    <option value="52">Fuel</option>\n    <option value="165">Fused Modular Frame</option>\n    <option value="247">Gas Filter</option>\n    <option value="244">Hatcher Protein</option>\n    <option value="164">Heat Sink</option>\n    <option value="114">Heavy Modular Frame</option>\n    <option value="154">High-Speed Connector</option>\n    <option value="238">Hog Protein</option>\n    <option value="235">Iodine-Infused Filter</option>\n    <option value="15">Ionized Fuel</option>\n    <option value="258">Iron FICSMAS Ornament</option>\n    <option value="3">Iron Ingot</option>\n    <option value="36">Iron Ore (Limestone)</option>\n    <option value="1">Iron Plate</option>\n    <option value="2">Iron Rod</option>\n    <option value="37">Limestone (Sulfur)</option>\n    <option value="75">Liquid Biofuel</option>\n    <option value="159">Magnetic Field Generator</option>\n    <option value="115">Modular Engine</option>\n    <option value="123">Modular Frame</option>\n    <option value="107">Motor</option>\n    <option value="13">Neural-Quantum Processor</option>\n    <option value="137">Nitric Acid</option>\n    <option value="38">Nitrogen Gas (Bauxite)</option>\n    <option value="39">Nitrogen Gas (Caterium)</option>\n    <option value="138">Non-Fissile Uranium</option>\n    <option value="143">Nuclear Pasta</option>\n    <option value="98">Packaged Alumina Solution</option>\n    <option value="74">Packaged Fuel</option>\n    <option value="78">Packaged Heavy Oil Residue</option>\n    <option value="16">Packaged Ionized Fuel</option>\n    <option value="76">Packaged Liquid Biofuel</option>\n    <option value="142">Packaged Nitric Acid</option>\n    <option value="167">Packaged Nitrogen Gas</option>\n    <option value="77">Packaged Oil</option>\n    <option value="6">Packaged Rocket Fuel</option>\n    <option value="152">Packaged Sulfuric Acid</option>\n    <option value="46">Packaged Turbofuel</option>\n    <option value="79">Packaged Water</option>\n    <option value="53">Petroleum Coke</option>\n    <option value="54">Plastic</option>\n    <option value="141">Plutonium Fuel Rod</option>\n    <option value="140">Plutonium Pellet</option>\n    <option value="136">Pressure Conversion Cube</option>\n    <option value="89">Quartz Crystal</option>\n    <option value="236">Quickwire</option>\n    <option value="150">Radio Control Unit</option>\n    <option value="40">Raw Quartz (Bauxite)</option>\n    <option value="41">Raw Quartz (Coal)</option>\n    <option value="24">Reanimated SAM</option>\n    <option value="255">Red FICSMAS Ornament</option>\n    <option value="265">Reinforced Iron Plate</option>\n    <option value="56">Residual Fuel</option>\n    <option value="57">Residual Plastic</option>\n    <option value="58">Residual Rubber</option>\n    <option value="5">Rocket Fuel</option>\n    <option value="124">Rotor</option>\n    <option value="55">Rubber</option>\n    <option value="19">SAM Fluctuator</option>\n    <option value="267">Screw</option>\n    <option value="100">Silica</option>\n    <option value="233">Singularity Cell</option>\n    <option value="126">Smart Plating</option>\n    <option value="251">Smokeless Powder</option>\n    <option value="237">Solid Biofuel</option>\n    <option value="239">Spitter Protein</option>\n    <option value="108">Stator</option>\n    <option value="68">Steel Beam</option>\n    <option value="70">Steel Ingot</option>\n    <option value="69">Steel Pipe</option>\n    <option value="243">Stinger Protein</option>\n    <option value="42">Sulfur (Coal)</option>\n    <option value="43">Sulfur (Iron)</option>\n    <option value="151">Sulfuric Acid</option>\n    <option value="149">Supercomputer</option>\n    <option value="12">Superposition Oscillator</option>\n    <option value="250">Synthetic Power Shard</option>\n    <option value="200">Thermal Propulsion Rocket</option>\n    <option value="22">Time Crystal</option>\n    <option value="199">Turbo Motor</option>\n    <option value="45">Turbofuel</option>\n    <option value="102">Unpackage Alumina Solution</option>\n    <option value="81">Unpackage Fuel</option>\n    <option value="83">Unpackage Heavy Oil Residue</option>\n    <option value="17">Unpackage Ionized Fuel</option>\n    <option value="80">Unpackage Liquid Biofuel</option>\n    <option value="144">Unpackage Nitric Acid</option>\n    <option value="168">Unpackage Nitrogen Gas</option>\n    <option value="82">Unpackage Oil</option>\n    <option value="7">Unpackage Rocket Fuel</option>\n    <option value="155">Unpackage Sulfuric Acid</option>\n    <option value="47">Unpackage Turbofuel</option>\n    <option value="84">Unpackage Water</option>\n    <option value="158">Uranium Fuel Rod</option>\n    <option value="44">Uranium Ore (Bauxite)</option>\n    <option value="71">Versatile Framework</option>\n    <option value="269">Wire</option>\n',c=function(){function o(){}return o.generatePowerTable=function(o,t,n){return o.map((function(o,n){return'\n      <tr>\n        <td class="m-0 p-0 w-50">\n          <select class="form-control rounded-0" name="power_building_id[]" min="0">\n            '.concat(t.replace('<option value="'.concat(o.buildingId,'">'),'<option value="'.concat(o.buildingId,'" selected>')),'\n          </select>\n        </td>\n        <td class="m-0 p-0 w-25">\n          <input type="number" value="').concat(o.quantity,'" class="form-control rounded-0" name="power_amount[]" min="0" step="any" data-index="').concat(n,'" onchange="updateConsumption()">\n        </td>\n        <td class="m-0 p-0 w-25">\n          <input type="number" value="').concat(o.clockSpeed,'" class="form-control rounded-0" name="power_clock_speed[]" min="1" max="250" step="any" data-index="').concat(n,'" onchange="updateConsumption()">\n        </td>\n        <td class="m-0 p-0 w-25">\n          <input type="number" value="').concat(o.Consumption,'" class="form-control rounded-0" disabled name="power_Consumption[]" min="0" step="any">\n        </td>\n        <td class="m-0 p-0 w-25">\n          <input type="hidden" value="').concat(o.userRow?1:0,'" class="form-control rounded-0" readonly name="user[]" min="0">\n        </td>\n      </tr>\n    ')})).join("")+'\n      <tr>\n        <td class="m-0 p-0 w-50">\n          <select class="form-control rounded-0" name="power_building_id[]" min="0">\n            '.concat(t.replace(/<option /,"<option selected "),' \x3c!-- Selects the first option --\x3e\n          </select>\n        </td>\n        <td class="m-0 p-0 w-25">\n          <input type="number" value="0" class="form-control rounded-0" name="power_amount[]" min="0" step="any" onchange="updateConsumption()">\n        </td>\n        <td class="m-0 p-0 w-25">\n          <input type="number" value="100" class="form-control rounded-0" name="power_clock_speed[]" min="1" max="250" step="any" onchange="updateConsumption()">\n        </td>\n        <td class="m-0 p-0 w-25">\n          <input type="number" value="0" class="form-control rounded-0" readonly name="power_Consumption[]" min="0" step="any">\n        </td>\n        <td class="m-0 p-0 w-25">\n          <input type="hidden" value="1" class="form-control rounded-0" readonly name="user[]" min="0">\n        </td>\n      </tr>\n    ')+'\n      <tr>\n        <td colspan="1" class="table-dark">\n          Total:\n        </td>\n        <td colspan="2"></td>\n        <td class="w-25 m-0 p-0">\n          <input type="number" name="total_consumption" readonly class="form-control rounded-0" id="totalConsumption" value="'.concat(n,'">\n        </td>\n      </tr>\n    ')},o.generateImportsTableRows=function(o){return o.map((function(o){var t=Number(o.quantity)%1==0?o.quantity.toFixed(0):o.quantity.toFixed(1);return'\n            <tr>\n                <td class="m-0 p-0 w-75">\n                    <select name="imports_item_id[]" class="form-control rounded-0">\n                        '.concat(p.replace('value="'.concat(o.itemId,'"'),'value="'.concat(o.itemId,'" selected')),'\n                    </select>\n                </td>\n                <td class="m-0 p-0 w-25">\n                    <input min="0" type="number" name="imports_ammount[]" class="form-control rounded-0" value="').concat(t,'" readonly>\n                </td>\n            </tr>\n        ')})).join("")+'\n        <tr>\n            <td class="m-0 p-0 w-75">\n                <select name="imports_item_id[]" class="form-control rounded-0">\n                    '.concat(p.replace(/<option /,"<option selected "),' \x3c!-- Selects the first option --\x3e\n                </select>\n            </td>\n            <td class="m-0 p-0 w-25">\n                <input min="0" type="number" name="imports_ammount[]" class="form-control rounded-0">\n            </td>\n        </tr>')},o.generateProductionTableRows=function(o){return o.map((function(o){var t,n,e,i="",a="",r="";return o.doubleExport&&(i='style="height: 78px"',r='rowspan="2"',a='\n            <tr class="extra-output">\n                <td class="m-0 p-0">\n                    <input type="text" readonly class="form-control rounded-0 product-name" value="'.concat(null===(t=o.extraCells)||void 0===t?void 0:t.Product,'">\n                </td>\n                <td class="m-0 p-0">\n                    <input min="0" type="number" step="any" name="production_usage2[]" value="').concat(null===(n=o.extraCells)||void 0===n?void 0:n.Usage,'" required readonly class="form-control rounded-0 usage-amount">\n                </td>\n                <td class="m-0 p-0">\n                    <input min="0" type="number" step="any" name="production_export2[]" value="').concat(null===(e=o.extraCells)||void 0===e?void 0:e.Quantity,'" required readonly class="form-control rounded-0 export-amount">\n                </td>\n            </tr>\n            ')),' <tr>\n          <td class="m-0 p-0" '.concat(r,'>\n            <select name="production_recipe_id[]" class="form-control rounded-0 item-recipe-id recipe" ').concat(i,">\n              ").concat(s.replace('value="'.concat(o.recipeId,'"'),'value="'.concat(o.recipeId,'" selected')),'\n            </select>\n          </td>\n          <td class="m-0 p-0" ').concat(r,'>\n            <input min="0" type="number" step="any" name="production_quantity[]" value="').concat(o.quantity,'" required class="form-control rounded-0 production-quantity" ').concat(i,'>\n          </td>\n          <td class="m-0 p-0">\n            <input type="text" readonly class="form-control rounded-0 product-name" value="').concat(o.product,'">\n          </td>\n          <td class="m-0 p-0">\n            <input min="0" type="number" step="any" name="production_usage[]" value="').concat(o.Usage,'" required readonly class="form-control rounded-0 usage-amount">\n          </td>\n          <td class="m-0 p-0">\n            <input min="0" type="number" step="any" name="production_export[]" value="').concat(o.exportPerMin,'" required readonly class="form-control rounded-0 export-amount">\n          </td>\n        </tr>\n        ').concat(a,"\n        ")})).join("")+'\n        <tr>\n            <td class="m-0 p-0">\n                <select name="production_recipe_id[]" class="form-control rounded-0 item-recipe-id recipe">\n                    '.concat(s.replace(/<option /,"<option selected "),'\n                </select>\n            </td>\n            <td class="m-0 p-0">\n                <input min="0" type="number" value="0" step="any" name="production_quantity[]" required class="form-control rounded-0 production-quantity">\n            </td>\n            <td class="m-0 p-0">\n                <input type="text" readonly class="form-control rounded-0 product-name">\n            </td>\n            <td class="m-0 p-0">\n                <input min="0" type="number" value="0" step="any" name="production_usage[]" required readonly class="form-control rounded-0 usage-amount">\n            </td>\n            <td class="m-0 p-0">\n                <input min="0" type="number" value="0" step="any" name="production_export[]" required readonly class="form-control rounded-0 export-amount">\n            </td>\n        </tr>\n    ')},o}(),d=function(){function o(){}return o.calculateBuildings=function(t,n){var e=n.filter((function(o){return 1==o.userRow}));e.pop();for(var i=[],a=function(n){var e=t[n],a=e.recipe;if(null!==a){var r=a.building,u=e.quantity,p=i.find((function(o){return o.buildingId===r.id})),s=u/a.export_amount_per_min,c=0,d=+o.calculateConsumption(s,100,r.power_used);if(s%1!=0&&(c=s%1,s=Math.floor(s)),p?(p.quantity+=s,p.Consumption=+o.calculateConsumption(p.quantity,100,r.power_used)):i.push(new l(r.id,s,100,d,!1,r)),c>0){var v=100*c,m=+o.calculateConsumption(1,v,r.power_used);i.push(new l(r.id,1,+v.toFixed(1),m,!1,r))}}},r=0;r+1<t.length;r++)a(r);i=i.concat(e);var p=c.generatePowerTable(i,u,o.calculateTotalConsumption(i));return $("#power tbody").html(p),i.push(new l),i},o.calculateConsumption=function(o,t,n){return(o*n*Math.pow(t/100,1.321928)).toFixed(1)},o.calculateTotalConsumption=function(o){var t=o.filter((function(o){return 0!==o.Consumption})).reduce((function(o,t){return o+(Number(t.Consumption)||0)}),0);return parseFloat(t.toFixed(3))},o.calculateSingleConsumption=function(o){if(null===o.building)return 0;var t=Math.pow(o.clockSpeed/100,1.321928);return+(o.quantity*o.building.power_used*t).toFixed(1)},o.updateBuilding=function(n,e){return i=this,a=void 0,l=function(){var i;return function(o,t){var n,e,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(u){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(r=0)),r;)try{if(n=1,e&&(i=2&l[0]?e.return:l[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,l[1])).done)return i;switch(e=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,e=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(o,r)}catch(o){l=[6,o],e=0}finally{n=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}}(this,(function(a){switch(a.label){case 0:return i=n,[4,t.getBuilding(e)];case 1:return i.building=a.sent(),n.buildingId=e,n.Consumption=+o.calculateSingleConsumption(n),[2]}}))},new((r=void 0)||(r=Promise))((function(o,t){function n(o){try{u(l.next(o))}catch(o){t(o)}}function e(o){try{u(l.throw(o))}catch(o){t(o)}}function u(t){var i;t.done?o(t.value):(i=t.value,i instanceof r?i:new r((function(o){o(i)}))).then(n,e)}u((l=l.apply(i,a||[])).next())}));var i,a,r,l},o.updateTotalConsumption=function(t){var n=o.calculateTotalConsumption(t);$("#totalConsumption").val(n)},o}(),v=function(o,t,n,e){void 0===o&&(o=0),void 0===t&&(t=0),void 0===n&&(n=""),void 0===e&&(e=!1),this.index=o,this.amount=t,this.product=n,this.doubleExport=e},m=function(){function t(){}return t.calculateImports=function(t){for(var n,e=[],i=this.resetUsage(t),a=0;a+1<t.length;a++){var r=t[a],l=null===(n=r.recipe)||void 0===n?void 0:n.resources,u=this.calculateProductionRate(r);l&&this.processRequiredItems(l,u,r,t,e,i)}var p=c.generateImportsTableRows(e);return $("#imports tbody").html(p),e.push(new o),{importsTableRows:e,indexes:i}},t.resetUsage=function(o){for(var t=[],n=0,e=o;n<e.length;n++){var i=e[n];if(i.productionImports=[],i.imports=[],i.Usage>0&&(t.push(o.indexOf(i)),i.Usage=0,i.exportPerMin=i.quantity),null!==i.extraCells&&i.extraCells.Usage>0){var a=o.indexOf(i);-1===a||t.includes(a)||t.push(a),i.extraCells.Usage=0,i.extraCells.ExportPerMin=i.extraCells.Quantity}}return t},t.calculateProductionRate=function(o){var t;return(null===(t=o.recipe)||void 0===t?void 0:t.export_amount_per_min)?o.quantity/o.recipe.export_amount_per_min:0},t.processRequiredItems=function(o,t,n,e,i,a){for(var r=function(o){var r=o.importAmount*t,u=e.filter((function(t){return t.product===o.name})),p=e.filter((function(t){return null!==t.extraCells&&t.extraCells.Product===o.name})),s=0,c=0,d=l.processProducedRows(u,r,c,s,e,a,n,o.name);c=d.totalUsed,s=d.totalAvailable;var v=l.processDoubleExportRows(p,r,c,s,e,a,n,o.name),m=v.totalUsed;s=v.totalAvailable;var h=r-(c=m);h>0&&l.addToImportsTable(i,o.itemId,h,n,o.name)},l=this,u=0,p=o;u<p.length;u++)r(p[u])},t.processProducedRows=function(o,t,n,e,i,a,r,l){for(var u=0,p=o;u<p.length;u++){var s=p[u],c=s.quantity-s.Usage,d=Math.min(c,t-n);if(!(d<=0)){s.Usage+=+d.toFixed(2),s.exportPerMin=+(s.quantity-s.Usage).toFixed(2),n+=d,e+=c;var m=i.indexOf(s);r.productionImports.push(new v(m,d,l)),-1===m||a.includes(m)||a.push(m)}}return{totalUsed:n,totalAvailable:e}},t.processDoubleExportRows=function(o,t,n,e,i,a,r,l){for(var u=0,p=o;u<p.length;u++){var s=p[u];if(null!==s.extraCells){var c=s.extraCells.Quantity-s.extraCells.Usage,d=Math.min(c,t-n);if(!(d<=0)){s.extraCells.Usage+=+d.toFixed(2),s.extraCells.ExportPerMin=+(s.extraCells.Quantity-s.extraCells.Usage).toFixed(2),n+=d,e+=c;var m=i.indexOf(s);r.productionImports.push(new v(m,d,l,!0)),-1===m||a.includes(m)||a.push(m)}}}return{totalUsed:n,totalAvailable:e}},t.addToImportsTable=function(t,n,e,i,a){var r=t.find((function(o){return o.itemId===n}));e=+e.toFixed(2),r?(r.quantity+=e,i.imports.push(new v(t.indexOf(r),e,a))):(t.push(new o(n,e,a)),i.imports.push(new v(t.length-1,e,a)))},t}(),h=function(){function o(){this.autoImportExport=!0,this.autoPowerMachine=!0,this.autoSave=!1,this.addEventListeners(),this.applyChanges()}return o.prototype.applyChanges=function(){var o=new URL(window.location.href),t=parseInt(o.searchParams.get("id")),n=document.getElementById("auto_import_export"),e=document.getElementById("auto_power_machine");n&&(this.autoImportExport=n.checked),e&&(this.autoPowerMachine=e.checked),this.saveSettings(t)},o.prototype.addEventListeners=function(){var o=this,t=document.getElementById("auto_import_export"),n=document.getElementById("auto_power_machine");t&&t.addEventListener("change",(function(){$("#auto_import_export").parent().parent().tooltip("hide"),o.applyChanges()})),n&&n.addEventListener("change",(function(){$("#auto_power_machine").parent().parent().tooltip("hide"),o.applyChanges()}))},o.prototype.saveSettings=function(o){$.ajax({type:"POST",url:"updateProductionLineSettings",data:{productionLineId:o,autoImportExport:this.autoImportExport,autoPowerMachine:this.autoPowerMachine,autoSave:this.autoSave}})},o}(),f=function(o,t,n){this.id=o,this.product=t,this.quantity=n},w=function(o,t,n,e,i){this.id=o,this.product=t,this.quantity=n,this.building=e,this.buildingId=i},b=function(o,t,n){this.id=o,this.product=t,this.quantity=n},y=function(o,t,n,e,i){this.id=o,this.sourceId=t,this.targetId=n,this.quantity=e,this.product=i},g=function(){function o(o){this.importNodes=[],this.productionNodes=[],this.exportNodes=[],this.importConnections=[],this.productionConnections=[],this.exportConnections=[],this.TableHandler=o,this.getImportNodes(),this.getProduction(),this.getExportNodes(),this.getImportConnection(),console.log(this),console.log(this.TableHandler)}return o.prototype.getImportNodes=function(){for(var o=0;o<this.TableHandler.importsTableRows.length;o++){var t=this.TableHandler.importsTableRows[o];this.importNodes.push(new f(o,t.product,t.quantity))}},o.prototype.getImportConnection=function(){for(var o=0,t=0;t<this.TableHandler.productionTableRows.length;t++)for(var n=this.TableHandler.productionTableRows[t],e=0;e<n.imports.length;e++){var i=n.imports[e];this.importConnections.push(new y(o,i.index,t,i.amount,i.product)),o++}},o.prototype.getProduction=function(){for(var o,t=0;t<this.TableHandler.productionTableRows.length;t++){var n=this.TableHandler.productionTableRows[t],e=null===(o=n.recipe)||void 0===o?void 0:o.building;e&&this.productionNodes.push(new w(t,n.product,n.quantity,e.name,e.id));for(var i=0;i<n.productionImports.length;i++){var a=n.productionImports[i];this.productionConnections.push(new y(t,a.index,t,a.amount,a.product))}}},o.prototype.getExportNodes=function(){for(var o,t,n,e=0,i=0;i<this.TableHandler.productionTableRows.length;i++){var a=this.TableHandler.productionTableRows[i];a.exportPerMin>0&&(this.exportNodes.push(new b(e,a.product,a.exportPerMin)),this.exportConnections.push(new y(e,i,this.exportNodes.length-1,a.exportPerMin,a.product)),e++),(null===(o=a.extraCells)||void 0===o?void 0:o.ExportPerMin)>0&&(this.exportNodes.push(new b(e,a.product,null===(t=a.extraCells)||void 0===t?void 0:t.ExportPerMin)),this.exportConnections.push(new y(e,i,this.exportNodes.length-1,null===(n=a.extraCells)||void 0===n?void 0:n.ExportPerMin,a.product)),e++)}},o}(),C=function(){function o(){}return o.prepareSaveData=function(o,t,n){return{productionTableRows:o,powerTableRows:t,importsTableRows:n}},o.saveProductionLine=function(o){var n=this;try{var e=new URL(window.location.href),i=parseInt(e.searchParams.get("id"));t.saveData(o,i).then((function(o){o.success?n.showSuccessMessage("Data successfully saved."):n.showErrorMessage("An error occurred while saving the data. Please try again.")})).catch((function(o){n.showErrorMessage("An error occurred while saving the data. Please try again.")}))}catch(o){this.showErrorMessage("An error occurred while saving the data. Please try again.")}},o.showSuccessMessage=function(o){this.showMessage("saveSuccessAlert",o)},o.showErrorMessage=function(o){this.showMessage("saveErrorAlert",o)},o.showMessage=function(o,t){var n=document.getElementById(o);n&&(n.textContent=t,n.classList.add("d-none"),n.classList.remove("show"),n.offsetWidth,n.classList.remove("d-none"),n.classList.add("show"),setTimeout((function(){n.classList.remove("show"),setTimeout((function(){n.classList.add("d-none")}),150)}),5e3))},o}(),x=function(o,t,n,e){return new(n||(n=Promise))((function(i,a){function r(o){try{u(e.next(o))}catch(o){a(o)}}function l(o){try{u(e.throw(o))}catch(o){a(o)}}function u(o){var t;o.done?i(o.value):(t=o.value,t instanceof n?t:new n((function(o){o(t)}))).then(r,l)}u((e=e.apply(o,t||[])).next())}))},A=function(o,t){var n,e,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(u){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(r=0)),r;)try{if(n=1,e&&(i=2&l[0]?e.return:l[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,l[1])).done)return i;switch(e=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,e=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(o,r)}catch(o){l=[6,o],e=0}finally{n=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}},S=function(){function t(){var t=this;this.settings=new h,this.importsTableRows=this.readTable("imports",o),this.productionTableRows=this.readTable("recipes",r),this.powerTableRows=this.readTable("power",l),this.addEventListeners(),$(document).on("keydown",(function(o){"v"===o.key&&o.ctrlKey&&(o.preventDefault(),t.showVisualization()),"s"===o.key&&o.ctrlKey&&(o.preventDefault(),C.saveProductionLine(C.prepareSaveData(t.productionTableRows,t.powerTableRows,t.importsTableRows)))}))}return t.prototype.readTable=function(o,t){var e,i=$("#".concat(o," tbody tr")),a=[],r=0;"power"===o&&(r=1);for(var l,u=function(r){var u=i[r],p=$(u).find("input, select"),s=[];if(p.each((function(o,t){"number"===$(t).attr("type")?s.push(Number($(t).val())):s.push($(t).val())})),"recipes"===o&&(null===(e=i[r+1])||void 0===e?void 0:e.classList.contains("extra-output"))){var c=i[r+1],d=$(c).find("input, select").map((function(o,t){return $(t).val()})).get(),v=new n(d[0],Number(d[1]),Number(d[2]));s.push(!0,v),r++}a.push(new(t.bind.apply(t,function(o,t,n){if(n||2===arguments.length)for(var e,i=0,a=t.length;i<a;i++)!e&&i in t||(e||(e=Array.prototype.slice.call(t,0,i)),e[i]=t[i]);return o.concat(e||Array.prototype.slice.call(t))}([void 0],s,!1)))),l=r},p=0;p<i.length-r;p++)u(p),p=l;return a},t.prototype.addEventListeners=function(){var o=this;["imports","recipes","power"].forEach((function(t){$("#".concat(t," tbody")).find("input, select").each((function(n,e){$(e).on("change",(function(n){o.handleInputChange(n,t)}))}))}))},t.prototype.addSpecificEventListener=function(o){var t=this;$("#".concat(o," tbody")).find("input, select").each((function(n,e){$(e).on("change",(function(n){t.handleInputChange(n,o)}))}))},t.prototype.handleInputChange=function(o,t){return x(this,void 0,void 0,(function(){var n,e,i,a,r,l;return A(this,(function(u){switch(u.label){case 0:if(n=$(o.target),e=n.closest("tr").index(),i=n.closest("tr").prevAll(".extra-output").length,a=n.closest("td").index(),r=n.val(),this.checkIfLastRow(n,t)&&this.checkIfSelect(n)&&this.addNewRow(t),!((l=this.getRowByTableIdAndIndex(t,e-i))&&a>=0))return[3,7];switch(this.updateRowData(l,a,r),t){case"imports":return[3,1];case"recipes":return[3,2];case"power":return[3,4]}return[3,6];case 1:case 6:return[3,7];case 2:return[4,this.HandleProductionTable(l,e,r,t,n)];case 3:case 5:return u.sent(),[3,7];case 4:return[4,this.HandlePowerTable(l,e,r,t,n)];case 7:return[2]}}))}))},t.prototype.getRowByTableIdAndIndex=function(o,t){switch(o){case"imports":return this.importsTableRows[t];case"recipes":return this.productionTableRows[t];case"power":return this.powerTableRows[t];default:return null}},t.prototype.updateRowData=function(o,t,n){o[Object.keys(o)[t]]=n},t.prototype.updateRowInTable=function(o,t,n){var e=$("#".concat(o," tbody tr")),i=$(e[t]);i.find("input, select").each((function(o,t){var e,i=Object.keys(n)[o];e=n.recipe&&n.recipe.hasOwnProperty(i)?n.recipe[i]:n[i],$(t).val(e)})),"recipes"===o&&a.handleDoubleExport(n,i)},t.prototype.addNewRow=function(t){var n,e=this,i=(n="power"===t?$("#".concat(t," tbody tr:nth-last-child(2)")):$("#".concat(t," tbody tr:last"))).clone();switch(i.find('input[type="number"]').val(0),i.find('input[type="text"]').val(""),i.find('input[name="power_clock_speed[]"]').val(100),i.find("select").prop("selectedIndex",0),i.insertAfter(n),i.find("input, select").each((function(o,n){$(n).on("change",(function(o){e.handleInputChange(o,t)}))})),t){case"imports":this.importsTableRows.push(new o);break;case"recipes":this.productionTableRows.push(new r);break;case"power":this.powerTableRows.push(new l)}},t.prototype.checkIfLastRow=function(o,t){return"power"===t?o.closest("tr").is(":nth-last-child(2)"):o.closest("tr").is(":last-child")},t.prototype.checkIfSelect=function(o){return o.is("select")},t.prototype.UpdateOnIndex=function(o){for(var t=0;t<o.length;t++){var n=o[t],e=(this.productionTableRows[n],this.productionTableRows.slice(0,n).filter((function(o){return o.doubleExport})).length),i=this.productionTableRows[n];this.updateRowInTable("recipes",n+e,i)}},t.prototype.HandlePowerTable=function(o,t,n,e,i){return x(this,void 0,void 0,(function(){return A(this,(function(a){switch(a.label){case 0:return this.checkIfSelect(i)?[4,d.updateBuilding(o,n)]:[3,2];case 1:return a.sent(),[3,3];case 2:o.Consumption=d.calculateSingleConsumption(o),a.label=3;case 3:return this.updateRowInTable(e,t,o),d.updateTotalConsumption(this.powerTableRows),[2]}}))}))},t.prototype.HandleProductionTable=function(o,t,n,e,i){return x(this,void 0,void 0,(function(){var r;return A(this,(function(l){switch(l.label){case 0:return[4,a.calculateProductionExport(o)];case 1:return l.sent(),this.checkIfSelect(i)?[4,a.updateRecipe(o,n)]:[3,3];case 2:l.sent(),l.label=3;case 3:return this.updateRowInTable(e,t,o),this.settings.autoImportExport&&(r=m.calculateImports(this.productionTableRows),this.importsTableRows=r.importsTableRows,this.UpdateOnIndex(r.indexes)),this.settings.autoPowerMachine&&(this.powerTableRows=d.calculateBuildings(this.productionTableRows,this.powerTableRows),this.addSpecificEventListener("power")),console.log(this),[2]}}))}))},t.prototype.saveData=function(t,n,e){this.productionTableRows=(t.pop(),t),this.powerTableRows=(n.pop(),n),this.importsTableRows=(e.pop(),e),this.generateTables(),this.powerTableRows.push(new l),this.productionTableRows.push(new r),this.importsTableRows.push(new o)},t.prototype.generateTables=function(){$("#power tbody").html(c.generatePowerTable(this.powerTableRows,u,d.calculateTotalConsumption(this.powerTableRows))),$("#imports tbody").html(c.generateImportsTableRows(this.importsTableRows)),$("#recipes tbody").html(c.generateProductionTableRows(this.productionTableRows)),this.addEventListeners()},t.prototype.showVisualization=function(){var o=m.calculateImports(this.productionTableRows);this.importsTableRows=o.importsTableRows,new g(this)},t}(),I=function(){function o(){}return o.importData=function(o){return t=this,n=void 0,i=function(){var t,n,e=this;return function(o,t){var n,e,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(u){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(r=0)),r;)try{if(n=1,e&&(i=2&l[0]?e.return:l[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,l[1])).done)return i;switch(e=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,e=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(o,r)}catch(o){l=[6,o],e=0}finally{n=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}}(this,(function(i){return this.checkIfFileIsSelected()&&this.checkIfFileIsJson()?(t=$("#importFile").prop("files")[0],(n=new FileReader).readAsText(t),n.onload=function(t){var n,i=JSON.parse(null===(n=t.target)||void 0===n?void 0:n.result);i.productionTable&&i.powerTable&&i.importTable?(o.saveData(i.productionTable,i.powerTable,i.importTable),e.showSuccessMessage("Data successfully imported.")):e.showErrorMessage("The selected file does not contain the required data.")},[2]):[2]}))},new((e=void 0)||(e=Promise))((function(o,a){function r(o){try{u(i.next(o))}catch(o){a(o)}}function l(o){try{u(i.throw(o))}catch(o){a(o)}}function u(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(o){o(n)}))).then(r,l)}u((i=i.apply(t,n||[])).next())}));var t,n,e,i},o.exportData=function(o){var t=o.productionTableRows,n=o.importsTableRows,e={productionTable:t,powerTable:o.powerTableRows,importTable:n},i=(new TextEncoder).encode(JSON.stringify(e)),a=new Blob([i],{type:"application/json"}),r=URL.createObjectURL(a),l=document.createElement("a");l.href=r,l.download=this.generateFileName(),l.click(),URL.revokeObjectURL(r),this.showSuccessMessage("Data successfully exported.")},o.checkIfFileIsSelected=function(){var o,t=document.getElementById("importFile");if(!(null===(o=t.files)||void 0===o?void 0:o.length)){t.classList.add("is-invalid");var n=t.nextElementSibling;return n&&n.classList.add("d-block"),!1}t.classList.remove("is-invalid");var e=t.nextElementSibling;return e&&e.classList.remove("d-block"),!0},o.checkIfFileIsJson=function(){var o,t=document.getElementById("importFile"),n=null===(o=t.files)||void 0===o?void 0:o[0];if(n&&"application/json"!==n.type){t.classList.add("is-invalid");var e=t.nextElementSibling;return e&&(e.textContent="Please select a valid JSON file.",e.classList.add("d-block")),!1}return!0},o.showMessage=function(o,t){var n=document.getElementById(o);n&&(n.textContent=t,n.classList.add("d-none"),n.classList.remove("show"),n.offsetWidth,n.classList.remove("d-none"),n.classList.add("show"),setTimeout((function(){n.classList.remove("show"),setTimeout((function(){n.classList.add("d-none")}),150)}),5e3))},o.showSuccessMessage=function(o,t){void 0===t&&(t=1),1!==t||this.showMessage("successAlert",o)},o.showErrorMessage=function(o,t){void 0===t&&(t=1),1!==t||this.showMessage("errorAlert",o)},o.generateFileName=function(){var o=Intl.DateTimeFormat().resolvedOptions().timeZone,t=(new Date).toLocaleString("en-GB",{timeZone:o}).replace(/[\/\s,:]/g,"_"),n=$("#productionLineName").text().replace("Production Line - ","");return n=n.replace(/\s/g,"_"),"".concat(n,"_data_").concat(t,".json")},o}(),P=new S,R=$("#save_button");R.on("click",(function(o){o.shiftKey&&(o.preventDefault(),C.saveProductionLine(C.prepareSaveData(P.productionTableRows,P.powerTableRows,P.importsTableRows)),R.tooltip("hide"),R.blur())}));var T=$("#exportButton"),k=$("#importButton");return T.on("click",(function(){I.exportData(P)})),k.on("click",(function(o){o.preventDefault(),I.importData(P)})),{}})()));